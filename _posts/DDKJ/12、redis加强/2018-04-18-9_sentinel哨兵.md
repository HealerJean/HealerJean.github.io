---
title: sentinel哨兵
date: 2018-03-06 03:33:00
tags: 
- Docker
category: 
- Docker
description: docker的安装和配置国内镜像加快下载速度
---
<!-- image url 
https://raw.githubusercontent.com/HealerJean123/HealerJean123.github.io/master/blogImages
　　首行缩进
<font color="red">  </font>
-->

## 前言


Redis主从复制下，一旦主节点由于故障不能提供服务需要人工将从节点晋升成主节点，因为代码中可能还是以主节点开发的，需要修改代码修改主节点。同时需要将其他节点的主节点要复制过来，这样肯定是不行，因为需要人工的干预

## 基本概念
对于Redis许多概念都有不同的名词解释，所以解释Redis Sentinel，Redis高可用实现方案

## 1、主从复制的问题

1、前言中介绍过
下面这两个属于redis分布式问题
2、主节点写能力受到单机的限制
3、主节点的存储能力受到单机的限制

## 2、Redis Sentinel高可用
它是一个分布式架构，其中包多个Sentinel节点和Redis数据节点，每个Sentinel节点会对数据节点和其余Sentinel节点进行监控，当它发现节点不可达的时候，会节点做下线标识，如果被标识的是主节点，它还会和其他Sentinel商量，当大部分人为主节点不可用的时候，会选举出一个Sentinel节点用来完成主节点的自动故障转移的工作，同时将这个变化通知给应用方，整个过程是自动的。不需要人工来介入

<font color="red">配置客户端体用这，客户端初始化的时候连接的Sentinel集合从中获取主节点信息，所以才有上面通知应用方，从而获取主节点信息  </font>

## 安装和部署
### 准备工作：

这里部署3个Sentinel（26379、26380、26381）、1个master（6379）、2个slave（6380、6381）

### 1、配置主节点

daemonize:redis采用的是单进程多线程的模式。当redis.conf中选项daemonize设置成yes时，代表开启守护进程模式。在该模式下，redis会在后台运行，并将进程pid号写入至redis.conf选项pidfile设置的文件中，此时redis将一直运行，除非手动kill该进程。

但当daemonize选项设置成no时，当前界面将进入redis的命令行界面，exit强制退出或者关闭连接工具(putty,xshell等)都会导致redis进程退出。

```
daemonize yes 
logfile "6379.log"
dbfilename dump-6379.rdb
dir ./data/
```




<br/><br/><br/>
如果满意，请打赏博主任意金额，感兴趣的请下方留言吧。可与博主自由讨论哦

|支付包 | 微信|微信公众号|
|:-------:|:-------:|:------:|
|![支付宝](https://raw.githubusercontent.com/HealerJean123/HealerJean123.github.io/master/assets/img/tctip/alpay.jpg) | ![微信](https://raw.githubusercontent.com/HealerJean123/HealerJean123.github.io/master/assets/img/tctip/weixin.jpg)|![微信公众号](https://raw.githubusercontent.com/HealerJean123/HealerJean123.github.io/master/assets/img/my/qrcode_for_gh_a23c07a2da9e_258.jpg)|




<!-- Gitalk 评论 start  -->

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> 
<div id="gitalk-container"></div>    
 <script type="text/javascript">
    var gitalk = new Gitalk({
		clientID: `1d164cd85549874d0e3a`,
		clientSecret: `527c3d223d1e6608953e835b547061037d140355`,
		repo: `HealerJean123.github.io`,
		owner: 'HealerJean123',
		admin: ['HealerJean123'],
		id: 'AAAAAAAAAAAAAA',
    });
    gitalk.render('gitalk-container');
</script> 

<!-- Gitalk end -->

