---
title: Json详细介绍
date: 2019-01-01 03:33:00
tags: 
- Json
category: 
- Json
description: Json详细介绍
---
<!-- image url 
https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/blogImages
　　首行缩进
<font color="red">  </font>
-->

## 前言

Json在项目开发中使用的太多了，各种关于Json的依赖也是不断地额退出，`JackJson` `net.sf.json` 以及阿里巴巴的Json，下面的将我实际项目中对于他们的使用做个介绍 。


### 1.1、net.sf.json

使用它最多的就是  `JSONObject` 、`JSONArray`直接对Json进行转换，但是使用它和对象进行交互不太友好，具体有关于date日期会引发很多麻烦，所以尽量不要使用它了，虽然`jackson`中没有`JSONObject`对象，但是提供了JsonNode。一般情况下我们使用`jackson`

### 1.2、jackson

我们一般使用它的objectMapper对Json进行对象的转化

### 1.3、com.alibaba.fastjson

这个我使用的不多，在序列化的时候使用过，一般没使用过

#### 1.4、com.google.gson

这个在小米知道fastjson有一些问题的时候，使用gson进行替换



## 1、`JSONObject` 和 `JSONArray`


### 1.1、一些方法


```java



/**
* JsonObject的基本使用
*/
@Test
public void jsonObject() {

   String jsonSTR = "{\n" +
           "    \"cars\": [\n" +
           "        \"奔驰\",\n" +
           "        \"宝马\"\n" +
           "    ],\n" +
           "    \"friends\": [\n" +
           "        {\n" +
           "            \"friendName\": \"小明\",\n" +
           "            \"friendSex\": \"男\"\n" +
           "        },\n" +
           "        {\n" +
           "            \"friendName\": \"小花\",\n" +
           "            \"friendSex\": \"女\"\n" +
           "        }\n" +
           "    ]\n" +
           "}" ;
   JSONObject jsonObject = JSONObject.fromObject(jsonSTR);


   //1、从JSONObject中获取数据
   String name  = jsonObject.getString("friendName");
   Integer integer = jsonObject.getInt("friendName");

   //2、判断JSONObject是否存在节点
   Boolean flag =  jsonObject.has("resultCount");

   //3、简单遍历 JSONObject
   for (Object key : jsonObject.keySet()) {
       Object object = jsonObject.get(key);
       System.out.println(object);
   }


   //4、简单遍历JSONArray
   JSONArray jsonArray = jsonObject.getJSONArray("friends");
   // JSONArray jsonArray =jsonObject.getJSONArray("cars");

   for (int i = 0; i < jsonArray.size(); i++) {
       Object object = jsonArray.get(i);
       System.out.println(object);
   }
   Iterator iterator = jsonArray.iterator();
   if(iterator.hasNext()){
       Object object = iterator.next();
       System.out.println(object);
   }

   // 5、JSONArray中获取 JSONObject对象
   JSONObject car =jsonObject.getJSONArray("friends").getJSONObject(0);
   System.out.println(car);
   // 虽然有下面这个方法，但是也要看情况是否能用，下面的会报错
   // JSONObject car =jsonObject.getJSONArray("cars").getJSONObject(0);


```


### 1.2、JSONObject 必须一个对象，而不是数组


```java
   
       /**
     *  1、数组不可以转换为JSONObject
     */
    @Test
    public void listToJSONObjectError(){

        List<String> list = new ArrayList<>();
        list.add("zhangcuihua");
        list.add("healerjean");

        String jsonStr = JsonUtils.toJsonString(list);
        System.out.println(jsonStr);
        // 打印结果["zhangcuihua","healerjean"]


        //1、报错 提示 JSONObject必须是包含 {
        // net.sf.json.JSONException: A JSONObject text must begin with '{' at character 1 of ["zhangcuihua","healerjean"]
        JSONObject jsonObject = JSONObject.fromObject(jsonStr);

    }
        
```

### 1.3、JSONArray ：普通数组、JSONObject数组

#### 1.3.1、Json字符串数据

JSONArray组，可以是JsonObject组成的数组，也可以是一个普通数组（比如：List集合），关于二者有大的区别，具体下面用一段代码来做个介绍

```json
{
    "username": "HealerJean",
    "sex": "男",
    "company": {
        "companyName": "梦想之都公司",
        "address": "北京海淀"
    },
    "cars": [
        "奔驰",
        "宝马"
    ],
    "friends": [
        {
            "friendName": "小明",
            "friendSex": "男"
        },
        {
            "friendName": "小花",
            "friendSex": "女"
        }
    ]
}
```

#### 1.3.2、生成Json对象 `GeneralBean`

```java

package com.hlj.proj.dto.sensitivity;

import com.hlj.proj.utils.JsonUtils;
import lombok.Data;
import lombok.experimental.Accessors;

import java.util.ArrayList;
import java.util.List;

/**
 * @author HealerJean
 * @version 1.0v
 * @ClassName GeneralBean
 * @date 2019-08-04  15:35.
 * @Description
 */
@Data
@Accessors(chain = true)
public class GeneralBean {

    private String username;

    private String sex;

    private Company company;

    private List<String> cars;

    private List<Friend> friends;


    public static void main(String[] args) {
        GeneralBean generalBean = new GeneralBean();
        generalBean.setUsername("HealerJean");
        generalBean.setSex("男");
        List<String> cars = new ArrayList<>();
        cars.add("奔驰");
        cars.add("宝马");
        generalBean.setCars(cars);

        Company company = new Company();
        company.setCompanyName("梦想之都公司");
        company.setAddress("北京海淀");
        generalBean.setCompany(company);


        Friend friendOne = new Friend();
        friendOne.setFriendName("小明");
        friendOne.setFriendSex("男");
        Friend friendTwo = new Friend();
        friendTwo.setFriendName("小花");
        friendTwo.setFriendSex("女");
        List<Friend> friends = new ArrayList<>();
        friends.add(friendOne);
        friends.add(friendTwo);
        generalBean.setFriends(friends) ;

        System.out.println(JsonUtils.toJsonString(generalBean));
    }

}

@Data
class Company {
    private String companyName;
    private String address;
}

@Data
class Friend {
    private String friendName;
    private String friendSex;
}


```


#### 1.3.3、测试

```java
 


    @Test
    public  void testJsonArray() {

        String jsonSTR = "{\n" +
                "    \"username\": \"HealerJean\",\n" +
                "    \"sex\": \"男\",\n" +
                "    \"company\": {\n" +
                "        \"companyName\": \"梦想之都公司\",\n" +
                "        \"address\": \"北京海淀\"\n" +
                "    },\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;
        
        JSONObject jsonObject = JSONObject.fromObject(jsonSTR);
        
        //1、获取Json的key集合
        for (Object key : jsonObject.keySet()) {
            //2、获取某个Key的值
            Object value = jsonObject.get(key);

            //2、判断是对象-JSONObject吗？
            if (value instanceof JSONObject) {
                System.out.println("JSONObject对象 ：" +value);
            }
            //3、判断是数组-JSONArray 吗？
            else if (value instanceof JSONArray) {
                //4、数组迭代
                Iterator it = ((JSONArray) value).iterator();
                while (it.hasNext()) {
                    Object object =  it.next() ;
                    if (object instanceof  JSONObject){
                        System.out.println("数组中的JSONObject :"+object);
                    }else {
                        System.out.println("普通数组："+object);
                    }
                }
             //7、 普通元素
            } else {
                System.out.println("普通元素："+value);
            }
        }
    }
    




// 普通元素：HealerJean
// 普通元素：男
// JSONObject对象 ：{"companyName":"梦想之都公司","address":"北京海淀"}
// 普通数组：奔驰
// 普通数组：宝马
// 数组中的JSONObject :{"friendName":"小明","friendSex":"男"}
// 数组中的JSONObject :{"friendName":"小花","friendSex":"女"}


```

## 2、JSONObjct 中data引发的血案

### 3.1、DateErrorJson 

```java
package com.hlj.proj.dto.sensitivity;

import com.hlj.proj.utils.JsonObjctMapperFewUtils;
import io.swagger.annotations.ApiModel;
import lombok.Data;
import lombok.ToString;
import lombok.experimental.Accessors;

import java.util.Date;

@Data
@Accessors(chain = true)
@ApiModel(description = "json测试实体")
@ToString
public class DateBean {


        private String name ;
        private Date date ;


    public static void main(String[] args) {
        DateBean dateBean = new DateBean();
        dateBean.setDate(new Date());
        dateBean.setName("HealerJean");
        System.out.println(JsonObjctMapperFewUtils.toJsonString(dateBean));
    }


}

```

### 3.2、Json日期的默认序列化方式为Long类型的

```java

  /**
     * 3、带有String类型的日期2018-12-13 20:31:04 转换为 Date类型的对象会报错，默认是Json是Long类型的才能成功，其实就是相当于序列化和反序列化以后都是Long类型的
     */
    @Test
    public void testStringDateOrLong() throws IOException {

        // 报错 String dateJsonSTR = "{\"name\":\"HealerJean\",\"date\":2018-12-13 20:31:04}\n" ;
        String dateJsonSTR = "{\"name\":\"HealerJean\",\"date\":1544782308409}\n" ;

        ObjectMapper objectMapper = new ObjectMapper();
        DateBean dateBean = objectMapper.readValue(dateJsonSTR,DateBean.class);

    }
    
    
```

### 3.3、JSONObject  会将对象中具有date的对象变质


```java


/**
     * 4、JSONObject  会将对象中具有date的对象变质
     * 4.1、不转换为Long类型的，反而转换为一堆参数，也就是说它将date内部进行转换了
     * 4.2、传递到前台是正常的
     */
    @Test
    public void jsonObjectDateERROR() throws IOException {

        DateBean dateBean = new DateBean();
        dateBean.setDate(new Date());
        dateBean.setName("HealerJean");

        System.out.println(JSONObject.fromObject(dateBean));
        // {"date":{"date":4,"day":0,"hours":16,"minutes":42,"month":7,"seconds":21,"time":1564908141006,"timezoneOffset":-480,"year":119},"name":"HealerJean"}


        Map<String, Object> map = (Map<String, Object>) JSONObject.fromObject(dateBean);
        ObjectMapper objectMapper = new ObjectMapper();
        System.out.println(objectMapper.writeValueAsString(map));
        // 下面这里发现date 变质了，但是传递到前台是正常的
        // {"date":{"date":4,"day":0,"hours":16,"minutes":47,"month":7,"seconds":38,"time":1564908458283,"timezoneOffset":-480,"year":119},"name":"HealerJean"}
    }


```

## 4、对象中的null字段转换

### 4.1、objectMapper 和  JSONObject 转换Json时关于NULL的不同


```java

/**
* 6、对象是空或者null的Json转换
* 6.1、Json中不论是字符串还是对象null，经过objectMapper转对象后还是null，
*      对象中的null，                经过objectMapper转json后也还是null
* 6.2、Json中不论是字符串还是对象null  经过JSONObject.fromObject后还是null
*      对象中如果字符串是null，       经过JSONObject.fromObject后会变成"" ，对象中的对象，（比如date）是null，转换后还是null ；
*/
@Test
public void nullOrEmpty() throws IOException {
   DateBean dateBean = new DateBean();
   dateBean.setDate(null);
   dateBean.setName(null);

   // 6.1、Json中不论是字符串还是对象null，经过objectMapper以后原封不动
   ObjectMapper objectMapper = new ObjectMapper();
   String jsonSTR =    objectMapper.writeValueAsString(dateBean);
   System.out.println(jsonSTR);
   //{"name":null,"date":null}       对象中的null，经过objectMapper转json后也还是null
   dateBean = objectMapper.readValue(jsonSTR,DateBean.class);
   System.out.println(dateBean);
   // DateBean(name=null, date=null) Json中不论是字符串还是对象null，经过objectMapper后还是null，


   // 6.2、Json中null的字符串通过 JSONObject.fromObject 后变成 "" ；
   JSONObject jsonObJect =  JSONObject.fromObject(dateBean) ;
   System.out.println(jsonObJect);
   // {"date":null,"name":""}    对象中如果字符串是null，则通过JSONObject.fromObject 后会变成"" ，对重中的对象，（比如date）是null，转换后还是null ；
   jsonObJect =  JSONObject.fromObject(jsonSTR) ;
   System.out.println(jsonObJect);
   // {"name":null,"date":null} Json中不论是字符串还是对象null  经过JSONObject.fromObject后还是null


   // {"name":null,"date":null}
   // DateBean(name=null, date=null)
   // {"date":null,"name":""}
   // {"name":null,"date":null}
}




```


### 4.1、配置对象中null的元素转Json后不存在


```java

/**
* 7、配置对象中null的元素转Json后不存在
*/
@Test
public  void ignoreNull() throws JsonProcessingException {

   // 1、注解@JsonInclude(JsonInclude.Include.NON_NULL)

   // 2。objectmapper配置
   DateBean dateBean = new DateBean();
   dateBean.setDate(new Date());
   dateBean.setName(null);
   ObjectMapper objectMapper = new ObjectMapper();
   objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
   String jsonSTR =    objectMapper.writeValueAsString(dateBean);
   System.out.println(jsonSTR);
   // {"date":1564910951087}

}


```

## 5、JsonNode的使用

JsonNode是`com.fasterxml.jackson.databind.JsonNode`中的类，jackson没有JSONObject对象，但是提供了类似的，这个比较好用，以后如果是必要情况下使用Json对象的使用它，而不使用上面的JSONObject

### 5.1、Json字符串数据

```json

{
    "username": "HealerJean",
    "sex": "男",
    "company": {
        "companyName": "梦想之都公司",
        "address": "北京海淀"
    },
    "cars": [
        "奔驰",
        "宝马"
    ],
    "friends": [
        {
            "friendName": "小明",
            "friendSex": "男"
        },
        {
            "friendName": "小花",
            "friendSex": "女"
        }
    ]
}
```


### 5.1、JsonNode 基本方法

```java
 /**
     * 1、JsonNode 基本方法
     */
    @Test
    public void getNode(){


        String jsonSTR = "{\n" +
                "    \"username\": \"HealerJean\",\n" +
                "    \"sex\": \"男\",\n" +
                "    \"company\": {\n" +
                "        \"companyName\": \"梦想之都公司\",\n" +
                "        \"address\": \"北京海淀\"\n" +
                "    },\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;

        System.out.println(jsonSTR);

        //1、获取key的迭代集  rootNode.fieldNames()
        JsonNode rootNode = JsonUtils.toJsonNode(jsonSTR);
        Iterator<String> keys = rootNode.fieldNames();

        //2、获取数据值（默认取到的是JsonNode） rootNode.path("username")、  rootNode.get("username")
        JsonNode node = null ;
        node = rootNode.path("username");
        node = rootNode.get("username");


        //3、判断是不是数组（对象数组或者普通数组）
        Boolean  flag = null ;
        flag = node.isArray();

        //4、判断是不是对象
        flag = node.isObject() ;

        //5、判断是不是某种属性
        flag =  node.isBigDecimal() ;
        flag =  node.isBoolean() ;
        flag =  node.isFloat();

        //6、将获取的数据进行类型转换
        //6.1、String类型
        String str = null ;
        str = node.textValue() ;
        str = node.asText();
        str = node.toString() ;

        Integer  integer = node.intValue() ;
        BigDecimal bigDecimal = node.decimalValue();



    }
    
```

### 5.2、简单的遍历Json （和1.2基本一致）


```java

    @Test
    public void testNode(){


        String jsonSTR = "{\n" +
                "    \"username\": \"HealerJean\",\n" +
                "    \"sex\": \"男\",\n" +
                "    \"company\": {\n" +
                "        \"companyName\": \"梦想之都公司\",\n" +
                "        \"address\": \"北京海淀\"\n" +
                "    },\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;

        System.out.println(jsonSTR);


        JsonNode rootNode = JsonUtils.toJsonNode(jsonSTR);

        //1、获取Json节点的key集合
        Iterator<String> keys = rootNode.fieldNames();
        while (keys.hasNext()) {
            // 2、获取节点的key值
            String key = keys.next();

            //3、获取key获取某个节点
            JsonNode jsonNode = rootNode.get(key);
            //4、判断节点是一个对象
            if (jsonNode.isObject()) {
                System.out.println("对象："+jsonNode);
            }
            //5、判断节点是数组
            else if (jsonNode.isArray()) {
                // 普通数组没有fieldName ，所以得到的name内部不存在，不会进入while循环，但是也不会报错
                // Iterator<String> nodeKeys = jsonNode.fieldNames();
                // while (nodeKeys.hasNext()) {
                //     log.info("nodeKeys.next()" + nodeKeys.next());
                //}
                for (JsonNode node : jsonNode) {
                    if(node.isObject()){
                        System.out.println("数组中的对象 :"+node);
                    }else {
                        System.out.println("普通数组："+node);
                    }
                }

            }//
            else {
                System.out.println("普通元素："+jsonNode);
            }
        }

    }



普通元素："HealerJean"
普通元素："男"
对象：{"companyName":"梦想之都公司","address":"北京海淀"}
普通数组："奔驰"
普通数组："宝马"
数组中的对象 :{"friendName":"小明","friendSex":"男"}
数组中的对象 :{"friendName":"小花","friendSex":"女"}

```


## 6、拼接一个Json

```java

@Test
public   void packageRequestParams() {
   StringBuffer jsonBuffer = new StringBuffer();
   /**
    * 拼接系统参数
    */
   jsonBuffer.append("{");

   jsonBuffer.append("\"name\":");
   jsonBuffer.append("\"");
   jsonBuffer.append("HealerJean");
   jsonBuffer.append("\",");

   jsonBuffer.append("\"age\":");
   jsonBuffer.append("\"\",");

   jsonBuffer.append("\"sex\":");
   jsonBuffer.append("\"男\"");


   jsonBuffer.append("}");

   JsonNode jsonNode = JsonUtils.toJsonNode(jsonBuffer.toString());
   System.out.println(jsonNode);

   // {"name":"HealerJean","age":"","sex":"男"}
}

name":"H
```

## 7、jackJson Json转集合 


```java
/**
 * @author HealerJean
 * @ClassName D05Collection
 * @date 2019-08-04  18:56.
 * @Description
 */
public class D05Collection {


    @Test
    public void colect() {


        DateBean one = new DateBean();
        one.setDate(new Date());
        one.setName("HealerJean");
        DateBean two = new DateBean();
        two.setDate(new Date());
        two.setName("zhangcui");
        List<DateBean> list = new ArrayList<>();
        list.add(one);
        list.add(two);
        String jsonSTR = JsonUtils.toJsonString(list);


        List<DateBean> dateBeans = null;
        dateBeans = JsonUtils.toObject(jsonSTR, new TypeReference<List<DateBean>>() {});
        System.out.println(dateBeans);

        JavaType javaType  = JsonUtils.toJavaType(new TypeReference<List<DateBean>>() {});
        dateBeans = JsonUtils.toObject(jsonSTR,javaType);
        System.out.println(dateBeans);

        dateBeans = JsonUtils.jsonToArray(jsonSTR,DateBean.class, ArrayList.class);
        System.out.println(dateBeans);

    }
}

```

## 8、Gson使用

### 8.1、对象转Json

```java
   /**
     * 1、对象转Json
     */
    @Test
    public void toJsonString(){
        Gson gson = new Gson();
        DateBean dateBean = new DateBean();
        dateBean.setDate(new Date());
        dateBean.setName("张宇晋");
        System.out.println(gson.toJson(dateBean));
       // {"name":"张宇晋","date":"Sep 12, 2019 2:11:52 PM"}
    }
```



### 8.2、json转Bean

```java

    /**
     * 2、Json转Bean
     */
    @Test
    public void toBean(){
        Gson gson = new Gson();
        //这个日期格式是错误的
        //   String dateJsonSTR = "{\"name\":\"HealerJean\",\"date\":1544782308409}";
        String dateJsonStr = "{\"name\":\"张宇晋\",\"date\":\"Sep 12, 2019 2:11:52 PM\"}";
        DateBean dateBean = gson.fromJson(dateJsonStr,DateBean.class);
        System.out.println(dateBean);
    }
```



### 8.3、json/对象转JsonObject



```java

    /**
     * 3、Json/对象转JsonObject
     */
    @Test
    public void toJsonObject(){
        String jsonStr = "{\"name\":\"张宇晋\",\"date\":\"Sep 12, 2019 2:11:52 PM\"}";
        JsonObject jsonObject = new JsonParser().parse(jsonStr).getAsJsonObject() ;
        System.out.println(jsonObject.toString());

        Gson gson = new Gson();
        DateBean dateBean = gson.fromJson(jsonStr,DateBean.class);
        jsonObject = new JsonParser().parse(gson.toJson(dateBean)).getAsJsonObject();
        System.out.println(jsonObject);
    }
```



### 8.4、JsonObject添加数据和读取数据

```java
  /**
     * 4、JsonObject添加数据和读取数据
     */
    @Test
    public void addAndGetParams(){
         String bigJson = "{\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;

        String paramJson = "{\"name\":\"张宇晋\",\"date\":\"Sep 12, 2019 2:11:52 PM\"}";

        JsonParser parser = new JsonParser();

        //将Json转化为JsonObejct
        JsonObject jsonObject = parser.parse(bigJson).getAsJsonObject() ;
        //1、添加基本数据
        jsonObject.addProperty("age",27);
        //2、添加Json对象
        JsonElement param = parser.parse(paramJson);
        jsonObject.add("param" ,param);
        System.out.println(jsonObject.toString());
        //{"cars":["奔驰","宝马"],"friends":[{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}],"age":27,"param":{"name":"张宇晋","date":"Sep 12, 2019 2:11:52 PM"}}


        System.out.println("jsonObject.getAsJsonObject() :"+ jsonObject.getAsJsonObject("param"));
        //{"name":"张宇晋","date":"Sep 12, 2019 2:11:52 PM"}
        System.out.println(jsonObject.get("age").getAsInt());
        //27
        System.out.println(jsonObject.get("cars").getAsJsonArray());
        //["奔驰","宝马"]
        System.out.println(jsonObject.get("cars").getAsJsonArray().get(0).getAsString());
        //奔驰
        System.out.println(jsonObject.get("friends").getAsJsonArray());
        // [{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}]
        System.out.println(jsonObject.get("friends").getAsJsonArray().get(0).getAsJsonObject().toString());
        //{"friendName":"小明","friendSex":"男"}

    }
```



### 8.5、json转集合

```java

    /**
     * 5、 json转集合
     */
    @Test
    public void toList(){

        DateBean one = new DateBean();
        one.setDate(new Date());
        one.setName("HealerJean");
        DateBean two = new DateBean();
        two.setDate(new Date());
        two.setName("zhangcui");
        List<DateBean> list = new ArrayList<>();
        list.add(one);
        list.add(two);

        String json = GsonUtil.toJsonString(list);

        list = GsonUtil.toList(json ,DateBean.class);
        System.out.println(list);

    }

```

​     

### 8.6、合并多个JsonObejct对象

```java

/**
* 合并多个JsonObejct对象
*/
public static JsonObject addAll(JsonObject targetJsonObect, JsonObject tempJsonObejct) {
    Set<String> keys = tempJsonObejct.keySet();
    for (String key : keys) {
        targetJsonObect.add(key, tempJsonObejct.get(key));
    }
    return targetJsonObect;
}
```



### 9.6、时间戳转化

```java
public class DateDeserializer implements JsonDeserializer<Date> {
    @Override
    public Date deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {
        return new Date(json.getAsJsonPrimitive().getAsLong());
    }
}


public class DateSerializer implements JsonSerializer<Date> {
    @Override
    public JsonElement serialize(Date src, Type typeOfSrc, JsonSerializationContext context) {
        return new JsonPrimitive(src.getTime());
    }
}


public class GsonUtil {

    private static Gson gson = null;
    private static JsonParser parser = null;

    static {
        GsonBuilder gb = new GsonBuilder();
        gb.registerTypeAdapter(java.util.Date.class, new DateSerializer()).setDateFormat(DateFormat.LONG);
        gb.registerTypeAdapter(java.util.Date.class, new DateDeserializer()).setDateFormat(DateFormat.LONG);
        gson = gb.create();
        parser = new JsonParser();

    }

```



## 9、FastJson



**这个大致和.net.sfc.json差不多**   

> 
>JSON.parseObject(str, clazz) 和 JSONObject.parseObject(str, clazz)区别
> 
>
> JSON是一个抽象类，JSON中有一个静态方法parseObject(String text)，将text解析为一个JSONObject对象并返回，JSONObject是一个继承自JSON的类，当调用JSONObject.parseObject(result)时，会直接调用父类的parseObject(String text)。所以两者没什么区别，一个是用父类去调用父类自己的静态的parseObject(String text)，一个是用子类去调用父类的静态parseObject(String text)，两者调的是同一个方法
> 



### 9.1、对象转转Json

```java
    /**
     * 1、对象转转Json
     */
    @Test
    public void toJson() {
        DateBean dateBean = new DateBean();
        dateBean.setName("HealerJean");
        dateBean.setDate(new Date());
        System.out.println(JSONObject.toJSONString(dateBean));
        // {"date":1568276603299,"name":"HealerJean"}
    }


```





### 9.2、json转对象

```java
    /**
     * json转对象
     */
    @Test
    public void toObject() {
        String json = "{\"date\":1568271783781,\"name\":\"HealerJean\"}";
        DateBean dateBean = JSONObject.parseObject(json, DateBean.class);
        System.out.println(dateBean);
    }

```



### 9.3、json/对象转JsonObject

```java
   /**
     * 3、 json/对象转JsonObject
     */
    @Test
    public void toJSONObject() {
        String json = "{\"date\":1568271783781,\"name\":\"HealerJean\"}";
        JSONObject jsonObject = JSONObject.parseObject(json);
        System.out.println(jsonObject);

        DateBean dateBean = new DateBean();
        dateBean.setName("HealerJean");
        dateBean.setDate(new Date());

        //需要先将对象转化为Json之后再转化为JSONObject对象
        jsonObject =   JSONObject.parseObject(JSONObject.toJSONString(dateBean));

    }

```



### 9.4、json转集合

```java

    /**
     * 4、 json转集合
     */
    @Test
    public void toList() {
        DateBean one = new DateBean();
        one.setDate(new Date());
        one.setName("HealerJean");
        DateBean two = new DateBean();
        two.setDate(new Date());
        two.setName("zhangcui");
        List<DateBean> list = new ArrayList<>();
        list.add(one);
        list.add(two);

        String json = JSONObject.toJSONString(list);
        JSONArray jsonObject = JSONObject.parseArray(json);
        System.out.println(jsonObject);

        list = JSONObject.parseArray(json, DateBean.class);
        System.out.println(list);
    }
```



### 9.5、添加和读取数据（包括：合并多个JsonObejct）



**读取数据和net.sf.json基本一致**



```java
 /**
     * 5、JsonObject添加数据和读取数据
     */
    @Test
    public void addAndGetParams(){
        String bigJson = "{\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;


        //1、添加数据
        JSONObject jsonObject = JSONArray.parseObject(bigJson);
        jsonObject.put("name" ,"HealerJean");
        System.out.println(jsonObject.toJSONString());
       //{"cars":["奔驰","宝马"],"name":"HealerJean","friends":[{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}]}

        //2、合并两个JsonObject
        String paramJson = "{\"name\":\"张宇晋\",\"date\":\"Sep 12, 2019 2:11:52 PM\"}";
        JSONObject paramJsonObject = JSONArray.parseObject(paramJson);
        jsonObject.putAll(paramJsonObject);
        System.out.println(jsonObject);
    //    {"date":"Sep 12, 2019 2:11:52 PM","cars":["奔驰","宝马"],"name":"张宇晋","friends":[{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}]}

    }

```











```java
package com.hlj.proj.service.test;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.hlj.proj.dto.DateBean;
import org.junit.Test;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * @author HealerJean
 * @ClassName D07FastJson
 * @date 2019/9/12  15:00.
 * @Description
 */
public class D07FastJson {



  

    /**
     * 3、 JSONObject
     */
    @Test
    public void toList() {
        DateBean one = new DateBean();
        one.setDate(new Date());
        one.setName("HealerJean");
        DateBean two = new DateBean();
        two.setDate(new Date());
        two.setName("zhangcui");
        List<DateBean> list = new ArrayList<>();
        list.add(one);
        list.add(two);

        String json = JSONObject.toJSONString(list);
        JSONArray jsonObject = JSONObject.parseArray(json);
        System.out.println(jsonObject);

        list = JSONObject.parseArray(json, DateBean.class);
        System.out.println(list);
    }



    /**
     * 5、JsonObject添加数据和读取数据
     */
    @Test
    public void addAndGetParams(){
        String bigJson = "{\n" +
                "    \"cars\": [\n" +
                "        \"奔驰\",\n" +
                "        \"宝马\"\n" +
                "    ],\n" +
                "    \"friends\": [\n" +
                "        {\n" +
                "            \"friendName\": \"小明\",\n" +
                "            \"friendSex\": \"男\"\n" +
                "        },\n" +
                "        {\n" +
                "            \"friendName\": \"小花\",\n" +
                "            \"friendSex\": \"女\"\n" +
                "        }\n" +
                "    ]\n" +
                "}" ;


        //1、添加数据
        JSONObject jsonObject = JSONArray.parseObject(bigJson);
        jsonObject.put("name" ,"HealerJean");
        System.out.println(jsonObject.toJSONString());
       //{"cars":["奔驰","宝马"],"name":"HealerJean","friends":[{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}]}

        //2、合并两个集合
        String paramJson = "{\"name\":\"张宇晋\",\"date\":\"Sep 12, 2019 2:11:52 PM\"}";
        JSONObject paramJsonObject = JSONArray.parseObject(paramJson);
        jsonObject.putAll(paramJsonObject);
        System.out.println(jsonObject);
    //    {"date":"Sep 12, 2019 2:11:52 PM","cars":["奔驰","宝马"],"name":"张宇晋","friends":[{"friendName":"小明","friendSex":"男"},{"friendName":"小花","friendSex":"女"}]}

    }


}

```





## 工具类

### GsonUtils



```java
package com.hlj.proj.utils;

import com.google.gson.*;

import java.util.ArrayList;
import java.util.List;

/**
 * @author HealerJean
 * @ClassName GsonUtils
 * @date 2019/9/12  11:41.
 * @Description
 */
public class GsonUtil {

    private static Gson gson = null;
    private static JsonParser parser = null;

    static {
        gson = new Gson();
        parser = new JsonParser();

    }

    /**
     * 转成json
     */
    public static String toJsonString(Object object) {
        return gson.toJson(object);
    }

    /**
     * 转成bean
     */
    public static <T> T toBean(String gsonString, Class<T> cls) {
        return gson.fromJson(gsonString, cls);
    }

    /**
     * 转换成JsonObject
     */
    public static JsonObject toJsonObject(String gsonString) {
        return parser.parse(gsonString).getAsJsonObject();
    }

    /**
     * 转换成数组
     */
    public static JsonArray toJsonArray(String gsonString) {
        return parser.parse(gsonString).getAsJsonArray();
    }

    /**
     * 转成list
     */
    public static <T> List<T> toList(String json, Class<T> cls) {
        List<T> list = new ArrayList<T>();
        JsonArray array = parser.parse(json).getAsJsonArray();
        for (final JsonElement elem : array) {
            list.add(gson.fromJson(elem, cls));
        }
        return list;
    }

    
    /**
    * 合并多个JsonObejct对象
    */
    public static JsonObject addAll(JsonObject targetJsonObect, 
                                    JsonObject tempJsonObejct) {
        Set<String> keys = tempJsonObejct.keySet();
        for (String key : keys) {
            targetJsonObect.add(key, tempJsonObejct.get(key));
        }
        return targetJsonObect;
    }

}

```



### JsonUtils

```java
package com.hlj.proj.utils;

import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.core.JsonGenerationException;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.*;
import com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;
import com.fasterxml.jackson.datatype.jsr310.deser.LocalDateDeserializer;
import com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateSerializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;
import com.hlj.proj.utils.sensitivity.SensitiveInfoUtils;
import com.hlj.proj.utils.sensitivity.SensitiveSerializerModifier;
import com.hlj.proj.utils.sensitivity.SensitiveTypeEnum;
import com.hlj.proj.utils.sensitivity.SensitivityConstants;

import java.io.IOException;
import java.io.Writer;
import java.lang.reflect.Type;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Map;
import java.util.Set;

/**
 * Utils - JSON
 */
public final class JsonUtils {

    /**
     * ObjectMapper
     */
    private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();
    private static final ObjectMapper objectMapperSensitivity = new ObjectMapper();


    static {


        OBJECT_MAPPER.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);

        //NULL 不打印
        OBJECT_MAPPER.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        // 排除json字符串中实体类没有的字段
        OBJECT_MAPPER.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);


        //LocalDateTime   LocalDate LocalTime 转化成 String
        JavaTimeModule javaTimeModule = new JavaTimeModule();
        javaTimeModule.addSerializer(LocalDateTime.class, new LocalDateTimeSerializer(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")));
        javaTimeModule.addSerializer(LocalDate.class, new LocalDateSerializer(DateTimeFormatter.ofPattern("yyyy-MM-dd")));
        javaTimeModule.addDeserializer(LocalDateTime.class, new LocalDateTimeDeserializer(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")));
        javaTimeModule.addDeserializer(LocalDate.class, new LocalDateDeserializer(DateTimeFormatter.ofPattern("yyyy-MM-dd")));

        OBJECT_MAPPER.registerModule(javaTimeModule);
        OBJECT_MAPPER.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);


        //脱敏日志创建
        objectMapperSensitivity.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        objectMapperSensitivity.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        objectMapperSensitivity.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        objectMapperSensitivity.registerModule(javaTimeModule);
        objectMapperSensitivity.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        //脱敏
        objectMapperSensitivity.setSerializerFactory(objectMapperSensitivity.getSerializerFactory().withSerializerModifier(new SensitiveSerializerModifier()));

    }

    public static ObjectMapper getObjectMapper() {
        return OBJECT_MAPPER;
    }


    /**
     * 将对象转换为JSON字符串
     *
     * @param value 对象
     * @return JSON字符串
     */
    public static String toJsonString(Object value) {
        try {
            return OBJECT_MAPPER.writeValueAsString(value);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }

    /**
     * 将JSON字符串转换为对象
     *
     * @param json JSON字符串
     * @param c    类型
     * @return 对象
     */
    public static <T> T toObject(String json, Class<T> c) {
        try {
            return OBJECT_MAPPER.readValue(json, c);
        } catch (IOException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }


    /**
     * json格式字符串转对象
     *
     * @param json
     * @param c
     * @return collect 仅限于 ArrayList HashSet 等集合对象
     */
    public static <T> T jsonToArray(String json, Class c, Class collect) {
        JavaType javaType = OBJECT_MAPPER.getTypeFactory().constructParametricType(collect, c);
        try {
            return OBJECT_MAPPER.readValue(json, javaType);
        } catch (IOException e) {
            throw new RuntimeException("参数格式有误");
        }
    }


    /**
     * 将JSON字符串转换为集合（也可以是set） 不可以是对象
     *
     * @param json          JSON字符串
     * @param typeReference 类型 可以通过这个转化为List集合 ，举例：
     *                      List<JavaBean> list =  JsonUtils.toObject(jsonArrayStr, new TypeReference<List<JavaBean>>() { });
     *                      Map<String, Object> map =  JsonUtils.toObject(JsonUtils.toJson(javaBean),new TypeReference<Map<String, Object>>( ){} );
     * @return 对象
     */
    public static <T> T toObject(String json, TypeReference<?> typeReference) {
        try {
            return OBJECT_MAPPER.readValue(json, typeReference);
        } catch (IOException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }


    /**
     * 将JSON字符串转换为对象
     *
     * @param json     JSON字符串
     * @param javaType 类型
     * @return 对象
     */
    public static <T> T toObject(String json, JavaType javaType) {
        try {
            return OBJECT_MAPPER.readValue(json, javaType);
        } catch (IOException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }


    /**
     * 将JSON字符串转换为树
     *
     * @param json JSON字符串
     * @return 树
     */
    public static JsonNode toJsonNode(String json) {
        try {
            return OBJECT_MAPPER.readTree(json);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e.getMessage(), e);
        } catch (IOException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }

    /**
     * 将对象转换为JSON流
     *
     * @param writer Writer
     * @param value  对象
     */
    public static void writeValue(Writer writer, Object value) {
        try {
            OBJECT_MAPPER.writeValue(writer, value);
        } catch (JsonGenerationException e) {
            throw new RuntimeException(e.getMessage(), e);
        } catch (JsonMappingException e) {
            throw new RuntimeException(e.getMessage(), e);
        } catch (IOException e) {
            throw new RuntimeException(e.getMessage(), e);
        }
    }


    /**
     * 将来通过 OBJECT_MAPPER.readValue(json, javaType) 转化为对象
     *
     * @param type （java.class）
     * @return 类型
     */
    public static JavaType toJavaType(Type type) {
        return OBJECT_MAPPER.getTypeFactory().constructType(type);
    }

    /**
     * 将来通过 OBJECT_MAPPER.readValue(json, javaType) 转化为 集合
     *
     * @param typeReference 类型 new TypeReference<List<JavaBean>>() { }
     * @return 类型
     */
    public static JavaType toJavaType(TypeReference<?> typeReference) {
        return OBJECT_MAPPER.getTypeFactory().constructType(typeReference);
    }


    /**
     * @param resString
     * @return String
     * @Description Json 格式化到控制台打印
     */
    public static String responseFormat(String resString) {

        StringBuffer jsonForMatStr = new StringBuffer();
        int level = 0;
        ////将字符串中的字符逐个按行输出
        for (int index = 0; index < resString.length(); index++) {
            //获取s中的每个字符
            char c = resString.charAt(index);

            //level大于0并且jsonForMatStr中的最后一个字符为\n,jsonForMatStr加入\t
            if (level > 0 && '\n' == jsonForMatStr.charAt(jsonForMatStr.length() - 1)) {
                jsonForMatStr.append(getLevelStr(level));
            }
            //遇到"{"和"["要增加空格和换行，遇到"}"和"]"要减少空格，以对应，遇到","要换行
            switch (c) {
                case '{':
                case '[':
                    jsonForMatStr.append(c + "\n");
                    level++;
                    break;
                case ',':
                    jsonForMatStr.append(c + "\n");
                    break;
                case '}':
                case ']':
                    jsonForMatStr.append("\n");
                    level--;
                    jsonForMatStr.append(getLevelStr(level));
                    jsonForMatStr.append(c);
                    break;
                default:
                    jsonForMatStr.append(c);
                    break;
            }
        }
        return jsonForMatStr.toString();
    }

    /**
     * @param level
     * @return
     * @throws
     */
    private static String getLevelStr(int level) {
        StringBuffer levelStr = new StringBuffer();
        for (int levelI = 0; levelI < level; levelI++) {
            levelStr.append("\t");
        }
        return levelStr.toString();
    }


    /**
     * 对象转Json格式字符串----脱敏处理(包含map)
     *
     * @return
     */
    public static String toJsonStringWithSensitivity(Object propName) {
        if (propName != null && propName instanceof Map) {
            Map map = (Map) propName;
            if (map != null && !map.isEmpty()) {
                Set<Map.Entry> set = map.entrySet();
                for (Map.Entry item : set) {
                    Object key = item.getKey();
                    Object value = item.getValue();
                    if (key instanceof String) {
                        String keyString = key.toString();
                        String s = dealSensitivity(keyString, value.toString());
                        map.put(keyString, s);
                    }
                }
            }
        }
        try {
            return objectMapperSensitivity.writeValueAsString(propName);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
        }
        return null;
    }

    private static String dealSensitivity(String mapkey, String mapValue) {
        //正则匹配
        for (Map.Entry<String, SensitiveTypeEnum> entry : SensitivityConstants.sensitivityRules.entrySet()) {
            String rule = entry.getKey();
            int length = rule.length();
            int propLen = mapkey.length();
            if (mapkey.length() < length) {
                continue;
            }
            int temp = rule.indexOf("*");
            String key = null;
            String substring = null;
            if (temp >= 0) {
                if (temp < (length >> 2)) {
                    key = rule.substring(temp + 1, length);
                    substring = mapkey.substring(propLen - key.length(), propLen);
                } else {
                    key = rule.substring(0, temp);
                    substring = mapkey.substring(0, temp);
                }
                if (substring.equals(key)) {
                    return SensitiveInfoUtils.sensitveValue(entry.getValue(), mapValue);
                }
            } else if (rule.equals(mapkey)) {
                return SensitiveInfoUtils.sensitveValue(entry.getValue(), mapValue);
            }
        }
        return mapValue;
    }


}




```

​      



### FastJsonUtils

```java
/**
 * @author HealerJean
 * @ClassName FastJsonUtils
 * @date 2019/9/12  14:54.
 * @Description
 * JSON是一个抽象类，JSON中有一个静态方法parseObject(String text)，将text解析为一个JSONObject对象并返回;
 * JSONObject是一个继承自JSON的类，当调用JSONObject.parseObject(result)时，会直接调用父类的parseObject(String text)。
 * 所以两者没什么区别，一个是用父类去调用父类自己的静态的parseObject(String text)，一个是用子类去调用父类的静态parseObject(String text)，两者调的是同一个方法
 */
public class FastJsonUtils {


    public static final String DEFAULT_DATEFORMAT = "yyyy-MM-dd HH:mm:ss";

    public static <T> T toObject(String str, Class<T> clazz) {
        // return JSON.parseObject(str, clazz);
       return   JSONObject.parseObject(str, clazz);

    }

    public static String toJsonString(Object obj) {
        return JSON.toJSONString(obj);
    }

    /**
     * json格式解析为List集合，不解决格式时间问题
     */
    public static <T> List<T> jsonTolist(String str, Class<T> clazz) {
        return JSON.parseArray(str, clazz);
    }

}

```









​     


如果满意，请打赏博主任意金额，感兴趣的在微信转账的时候，添加博主微信哦， 请下方留言吧。可与博主自由讨论哦

|支付包 | 微信|微信公众号|
|:-------:|:-------:|:------:|
|![支付宝](https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/assets/img/tctip/alpay.jpg) | ![微信](https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/assets/img/tctip/weixin.jpg)|![微信公众号](https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/assets/img/my/qrcode_for_gh_a23c07a2da9e_258.jpg)|




<!-- Gitalk 评论 start  -->

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> 
<div id="gitalk-container"></div>    
 <script type="text/javascript">
    var gitalk = new Gitalk({
		clientID: `1d164cd85549874d0e3a`,
		clientSecret: `527c3d223d1e6608953e835b547061037d140355`,
		repo: `HealerJean.github.io`,
		owner: 'HealerJean',
		admin: ['HealerJean'],
		id: 'kZrDneU7bajWTAl8',
    });
    gitalk.render('gitalk-container');
</script> 

<!-- Gitalk end -->

