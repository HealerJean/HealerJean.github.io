---
title: Kafka宝典
date: 2019-01-06 03:33:00
tags: 
- Kafka
category: 
- Kafka
description: Kafka宝典道
---

**前言**     

 Github：[https://github.com/HealerJean](https://github.com/HealerJean)         

 博客：[http://blog.healerjean.com](http://HealerJean.github.io)          





# 1、消息队列使用场景





> **消息发布者：**只管将消息发布到消息队列中而不需要管谁来获取。       

> **消息使用者：**只管从消息队列中取消息，而不管是谁发布的。这样发布者和使用者都不需要知道对方的存在

## 1.1、解耦 

> ⬤ 一个系统(模块)调用多个系统(模块)的场景      
>
> ⬤ 多个系统的添加或减少都需修改调用系统的代码       
>
> ⬤ 且不需要同步调用接口的情况  



**举例：签到后，送积分 。**从业务上来说，签到后我们一定要保证用户的签到正常，而积分的赠送我们可以延迟给用户传递，但是最终我们一定要保证签到后给积分，只是延迟而已。         

某一时刻积分服务不正常。不会影响到用户签到，专业积分服务即使报错了，我们后台可以自动重试，保证积分顺利送出，而不出现异常   

![image-20210801161052816](/Users/healerjean/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20210801161052816.png)





## 1.2、流量削峰

> 每个系统性能都是有极限的，类似淘宝双十一,数据量猛增,这个时候就需要把用户的请求放入消息队列中,每次从队列中取出最大数据(刚好不会使系统崩溃的数据),这样请求就会堆积在消息队列中,等到闲时请求就少了,但系统人以最大吞吐去处理数据，所以堆积消息很快会被解决



![image-20210801161153063](/Users/healerjean/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20210801161153063.png)



## 1.3、异步

> 涉及到时间消耗问题,当一个信息传入同时保存到多个系统，期间需要一个时间消耗，这时只需要信息先保存当前系统,剩下的放入消息队列

![image-20210801161352505](/Users/healerjean/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20210801161352505.png)







 ## 1.3、日志记录

> 相信没有人认为日志是不重要的，在我们已知的日志框架中，有可能会以为写入日志时的某些故障而导致业务系统访问阻塞，请求延迟，所以我们可以构建一个日志系统，用来提供分析数据  



## 1.4、事务一致性



> 举个例子，我正在开发的小米供应链金融，我们有用户的金额信息，我们也有个业务系统是账户系统，它里面也有余额信息，涉及到钱，我们就必须保证二者是一致的，   那么这个时候我们就可以使用消息队列来进行处理    



# 2、常见问题

## 2.1、为什么用消息队列而不是用接口

> 答案：     
>
> 1、解耦：一个生产者可以对应多个消费者应用服务         
>
> 2、流量削峰：放入消息队列可以消息挤压，慢慢处理消息（消费者挂掉之后，可以慢慢处理）           
>
> 3、异步处理：如果一个消息需要传递给多个消费者，使用消息的方式可以异步处理     

​                   



























![ContactAuthor](https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/assets/img/artical_bottom.jpg)



<!-- Gitalk 评论 start  -->

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> 
<div id="gitalk-container"></div>    
 <script type="text/javascript">
    var gitalk = new Gitalk({
		clientID: `1d164cd85549874d0e3a`,
		clientSecret: `527c3d223d1e6608953e835b547061037d140355`,
		repo: `HealerJean.github.io`,
		owner: 'HealerJean',
		admin: ['HealerJean'],
		id: '4DnXdEAr1ZK0FMTN',
    });
    gitalk.render('gitalk-container');
</script> 



<!-- Gitalk end -->



