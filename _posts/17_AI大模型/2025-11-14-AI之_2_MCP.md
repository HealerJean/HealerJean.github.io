---
title: AIä¹‹_2_MCP
date: 2025-11-14 00:00:00
tags: 
- AI
category: 
- AI
description: AIä¹‹_2_MCP
---

**å‰è¨€**     

 Githubï¼š[https://github.com/HealerJean](https://github.com/HealerJean)         

 åšå®¢ï¼š[http://blog.healerjean.com](http://HealerJean.github.io)          



# ä¸€ã€`MCP` åè®®

## 1ã€`MCP` åè®®çš„æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 1ï¼‰`MCP` æ˜¯ä»€ä¹ˆ? 

`MCP`ï¼ˆ`Model Context Protocol`ï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰æ˜¯ `Anthropic` äº 2024 å¹´ 11 æœˆå¼€æºçš„ `AI` é€šç”¨é€šä¿¡åè®®ã€‚`MCP` ç±»ä¼¼äºâ€œ`AI` é¢†åŸŸçš„ `USB` æ¥å£â€ï¼Œç”¨äºåœ¨å¤§æ¨¡å‹ï¼ˆ`LLM`ï¼‰å’Œå¤–éƒ¨æ•°æ®æºï¼ˆæ•°æ®åº“ã€å·¥å…·ã€`API`ã€å¼€å‘ç¯å¢ƒç­‰ï¼‰é—´å»ºç«‹å®‰å…¨ã€åŒå‘ã€æ ‡å‡†åŒ–çš„è¿æ¥ã€‚

- **MCP Hosts**: å¦‚ Claude Desktopã€IDE æˆ– AI å·¥å…·ï¼Œå¸Œæœ›é€šè¿‡ MCP è®¿é—®æ•°æ®çš„ç¨‹åº
- **MCP Clients**: ç»´æŠ¤ä¸æœåŠ¡å™¨ä¸€å¯¹ä¸€è¿æ¥çš„åè®®å®¢æˆ·ç«¯
- **MCP Servers**: è½»é‡çº§ç¨‹åºï¼Œé€šè¿‡æ ‡å‡†çš„ Model Context Protocol æä¾›ç‰¹å®šèƒ½åŠ›
- **æœ¬åœ°æ•°æ®æº**: MCP æœåŠ¡å™¨å¯å®‰å…¨è®¿é—®çš„è®¡ç®—æœºæ–‡ä»¶ã€æ•°æ®åº“å’ŒæœåŠ¡
- **è¿œç¨‹æœåŠ¡**: MCP æœåŠ¡å™¨å¯è¿æ¥çš„äº’è”ç½‘ä¸Šçš„å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚é€šè¿‡ APIsï¼‰

![image-20251118230102520](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118230102520.png)





### 2ï¼‰ä¸ºä»€ä¹ˆéœ€è¦ `MCP`ï¼Ÿ

- **ç¢ç‰‡åŒ–é—®é¢˜**ï¼šæ¯ä¸ª `AI` åº”ç”¨é‡å¤å¼€å‘å·¥å…·é›†æˆ

- **å®‰å…¨æŒ‘æˆ˜**ï¼šå¦‚ä½•æ§åˆ¶ `AI` å¯¹ç³»ç»Ÿçš„è®¿é—®æƒé™

- **äº’æ“ä½œæ€§**ï¼šä¸åŒæ¨¡å‹ã€ä¸åŒåº”ç”¨å¦‚ä½•ç»Ÿä¸€äº¤äº’



### 3ï¼‰`MCP` è®¾è®¡å“²å­¦ï¼šå¹³è¡¡ä¸‰å¯¹çŸ›ç›¾

> **ç±»æ¯”**ï¼šMCP å¦‚åŒ"AIä¸–ç•Œçš„HTTP"â€”â€”ç»Ÿä¸€åŸºç¡€æ ¼å¼ï¼Œä½†èƒ½æ‰¿è½½æ— é™åº”ç”¨

| çŸ›ç›¾å¯¹               | `MCP`è§£å†³æ–¹æ¡ˆ                           |
| -------------------- | --------------------------------------- |
| **æ ‡å‡†åŒ– vs ä¸ªæ€§åŒ–** | åŸºç¡€åè®®å›ºå®š + èƒ½åŠ›å£°æ˜æœºåˆ¶             |
| **å¼€æ”¾æ€§ vs å®‰å…¨æ€§** | ä¸‰çº§èƒ½åŠ›æ§åˆ¶ï¼ˆResources/Prompts/Toolsï¼‰ |
| **ç®€å•æ€§ vs å¼ºå¤§æ€§** | åˆ†å±‚è®¾è®¡ï¼Œæ¸è¿›å¼é‡‡ç”¨                    |



### 4ï¼‰é€šç”¨æ¶æ„-ä¸‰ä¸ªè§’è‰²çš„åˆ†å·¥

> `MCP` é‡‡ç”¨**å®¿ä¸»-å®¢æˆ·ç«¯-æœåŠ¡å™¨**ä¸‰å±‚æ¶æ„ï¼Œå°±åƒä¸€å®¶å…¬å¸çš„ç»„ç»‡ç»“æ„   

**äº¤äº’ï¼š**[`LLM/AI`åº”ç”¨] â”€â”€(`MCP`åè®®)â”€â”€> [`MCP` `Server`] â”€â”€> [æœ¬åœ°/è¿œç¨‹å·¥å…·/æ•°æ®æº]

**åŸºæœ¬æµç¨‹**ï¼š

1. `MCP` `Client` æ„å»ºå¹¶å‘é€è¯·æ±‚ã€‚
2. `MCP` `Server` è§£æã€éªŒè¯è¯·æ±‚å¹¶è°ƒç”¨åº•å±‚å·¥å…·ã€‚
3. å·¥å…·æ‰§è¡Œåï¼Œ`Server` å°†ç»“æœå°è£…å¹¶å›ä¼  `Client`ã€‚
4. `Client` è§£æç»“æœï¼Œæ•´åˆè¿› `LLM` /`AI`åº”ç”¨è¾“å‡ºã€‚



#### aã€å®¿ä¸»ï¼ˆ`Host`ï¼‰= **æ€»ç»ç†**

> æ˜¯ç”¨æˆ·ç›´æ¥äº¤äº’çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚æ¡Œé¢ç«¯çš„AIå·¥å…·ã€‚

- **æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å†³ç­–ä¸­å¿ƒï¼Œé€šå¸¸æ˜¯ç”¨æˆ·æˆ– `AI` æ¨¡å‹æœ¬èº«ã€‚**
- å†³å®šâ€œåšä»€ä¹ˆâ€ã€â€œç”¨ä»€ä¹ˆå·¥å…·â€ã€â€œå¦‚ä½•åšâ€ã€‚
- è®¾ç½®è®¿é—®ç­–ç•¥ï¼ˆæ¯”å¦‚å“ªäº›å·¥å…·å…è®¸è°ƒç”¨ï¼‰ã€‚
- ç¤ºä¾‹ï¼šä½ åœ¨ä½¿ç”¨ `Claude` æ—¶è¯´ï¼šâ€œå¸®æˆ‘å†™ä¸€ä¸ª `Python` å‡½æ•°å¹¶æµ‹è¯•å®ƒã€‚â€ â†’ è¿™å°±æ˜¯å®¿ä¸»å‘å‡ºçš„æŒ‡ä»¤ã€‚



| å¹³å°                            | ä¸‹è½½åœ°å€                   | è¯´æ˜                                           |
| ------------------------------- | -------------------------- | ---------------------------------------------- |
| **Cursor**                      | https://cursor.sh          | é¦–ä¸ªæ·±åº¦é›†æˆ MCP çš„ IDEï¼Œæ”¯æŒè‡ªå®šä¹‰ MCP Server |
| **Claude Desktopï¼ˆAnthropicï¼‰** | https://claude.ai/download | æ”¯æŒ â€œComputer Useâ€ åŠŸèƒ½ï¼Œåº•å±‚åŸºäº MCP         |
| **Windsurf (by exa.ai)**        | https://windsurf.com       | æ–°ä¸€ä»£ AI ç¼–è¾‘å™¨ï¼ŒåŸç”Ÿæ”¯æŒ MCP æ’ä»¶            |
| **Continue (å¼€æº)**             | https://continue.dev       | å¼€æº VS Code æ’ä»¶ï¼Œæ”¯æŒ MCP Server é›†æˆ        |





#### bã€å®¢æˆ·ç«¯ï¼ˆ`Client`ï¼‰= **ç§˜ä¹¦ / ååŠ©å‘˜**

> åœ¨`Host`å’Œ`MCP` `Server`ä¹‹é—´ä¿æŒè¿æ¥ï¼Œè´Ÿè´£åè®®é€šä¿¡ã€‚

- æ¥æ”¶å®¿ä¸»æŒ‡ä»¤ï¼Œè§£æä¸º `MCP` æ¶ˆæ¯ã€‚
- ä½¿ç”¨ `MCP` åè®®ä¸å„ä¸ªæœåŠ¡å™¨é€šä¿¡ã€‚
- å®ç°â€œä»»åŠ¡åˆ†è§£â€ä¸â€œç»“æœæ±‡æ€»â€ã€‚
- ç¤ºä¾‹ï¼š`IDE` æ’ä»¶æ”¶åˆ°â€œè¿è¡Œä»£ç â€æŒ‡ä»¤åï¼Œé€šè¿‡ `MCP` å‘é€è¯·æ±‚ç»™â€œ`Python` æ‰§è¡Œå™¨â€æœåŠ¡å™¨ã€‚



#### cã€æœåŠ¡å™¨ï¼ˆ`Server`ï¼‰= **ä¸šåŠ¡éƒ¨é—¨**

> æä¾›æä¾›å…·ä½“èƒ½åŠ›çš„æœåŠ¡å•å…ƒã€‚ï¼Œä¾›å®¢æˆ·ç«¯è®¿é—®ã€‚

- æ”¯æŒæ ‡å‡†åŒ–æ¥å£ï¼ˆå¦‚ `JSON over WebSocket`ï¼‰ã€‚
- å¯ç‹¬ç«‹éƒ¨ç½²ï¼Œæ— éœ€çŸ¥é“å…¶ä»–æœåŠ¡å™¨ã€‚
- ç¤ºä¾‹ï¼š
  - `MCP æœåŠ¡å™¨ A`ï¼šæœ¬åœ°æ•°æ®åº“æŸ¥è¯¢å™¨
  - `MCP æœåŠ¡å™¨ B`ï¼šä»£ç è§£é‡Šå™¨ï¼ˆæ”¯æŒ Python/JSï¼‰
  - `MCP æœåŠ¡å™¨ C`ï¼šè°ƒç”¨å¤–éƒ¨ Web APIï¼ˆå¦‚å¤©æ°”ã€ç¿»è¯‘ï¼‰



### 2ï¼‰åœºæ™¯æ¡ˆä¾‹-ç”¨ `MCP` æŸ¥è¯¢å¤©æ°”å¹¶ç”ŸæˆæŠ¥å‘Š

1. **å®¿ä¸»ï¼ˆ`Claude`ï¼‰** è¯´ï¼šâ€œè¯·æŸ¥åŒ—äº¬ä»Šå¤©çš„å¤©æ°”ï¼Œå¹¶å†™ä¸€ä»½ç®€æŠ¥ã€‚â€

2. å®¢æˆ·ç«¯è§£æè¯¥æŒ‡ä»¤ï¼Œåˆ¤æ–­éœ€è¦ï¼š

   - è°ƒç”¨å¤©æ°” `API`ï¼ˆæœåŠ¡å™¨ `C`ï¼‰
   - å†™å…¥æ–‡æ¡£ï¼ˆæœåŠ¡å™¨ `A`ï¼‰

3. å®¢æˆ·ç«¯å‘é€ `MCP` è¯·æ±‚ç»™æœåŠ¡å™¨ `C`ï¼š

   ```
   {
     "action": "call_api",
     "method": "GET",
     "url": "https://api.weather.com/beijing"
   }
   ```

4. **æœåŠ¡å™¨ `C`** è¿”å›æ•°æ® â†’ å®¢æˆ·ç«¯è½¬å‘ç»™å®¿ä¸»

5. **å®¿ä¸»** ç»¼åˆä¿¡æ¯ï¼Œç”ŸæˆæŠ¥å‘Š â†’ å®¢æˆ·ç«¯å°†å…¶ä¿å­˜è‡³æ–‡æ¡£æœåŠ¡å™¨ `A`





## 2ã€åè®®åˆ†å±‚æ¶æ„ï¼šåƒæ­ç§¯æœ¨ä¸€æ ·æ„å»ºç³»ç»Ÿ

### 1ï¼‰åˆ†å±‚è®¾è®¡å›¾è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åº”ç”¨å±‚ (ä¸ªæ€§åŒ–)          â”‚ â†â”€ ä½ çš„ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åŠŸèƒ½å±‚ (å¯é€‰æ‰©å±•)           â”‚ â†â”€ Resources/Prompts/Tools
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         æ ¸å¿ƒå±‚ (å¿…é¡»å®ç°)          â”‚ â†â”€ JSON-RPC 2.0 + åˆå§‹åŒ–æµç¨‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



### 2ï¼‰æ ¸å¿ƒå±‚ï¼šæ‰€æœ‰å®ç°å¿…é¡»æ”¯æŒ

- **`JSON-RPC 2.0` æ¶ˆæ¯æ ¼å¼**ï¼šè¯·æ±‚/å“åº”/é€šçŸ¥ä¸‰ç±»æ¶ˆæ¯
- **åˆå§‹åŒ–æ¡æ‰‹æµç¨‹**ï¼š`initialize` â†’ å“åº” â†’ `initialized`
- **åŸºç¡€é”™è¯¯å¤„ç†**ï¼šæ ‡å‡†åŒ–é”™è¯¯ç ï¼ˆ-32xxxç³»åˆ—ï¼‰

```json
// ä»»ä½•MCPå®ç°å¿…é¡»èƒ½å¤„ç†çš„æ ‡å‡†è¯·æ±‚
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05"
  }
}
```



### 2ï¼‰åŠŸèƒ½å±‚ï¼šæŒ‰éœ€é€‰æ‹©

- **å…³é”®æ´å¯Ÿ**ï¼šæœåŠ¡å™¨ä¸å¿…å®ç°æ‰€æœ‰åŠŸèƒ½ï¼
-  ä¾‹å¦‚ï¼šä¸€ä¸ªçº¯çŸ¥è¯†åº“æŸ¥è¯¢æœåŠ¡åªéœ€å®ç° `Resources`ï¼Œæ— éœ€ `Tools`

| åŠŸèƒ½ç»„          | è¯´æ˜           | å…¸å‹åœºæ™¯                      |
| --------------- | -------------- | ----------------------------- |
| **Resources**   | åªè¯»æ•°æ®è®¿é—®   | è¯»å–æ–‡ä»¶ã€æ•°æ®åº“å…ƒæ•°æ®        |
| **Prompts**     | é¢„å®šä¹‰å·¥ä½œæµ   | `/analyze-commits` ç­‰ç”¨æˆ·æŒ‡ä»¤ |
| **Tools**       | æ‰§è¡Œæ“ä½œ       | å†™å…¥æ–‡ä»¶ã€å‘é€é‚®ä»¶            |
| **Roots**       | èµ„æºæ ¹ç›®å½•ç®¡ç† | é™åˆ¶AIå¯è§èŒƒå›´                |
| **Sampling**    | LLMé‡‡æ ·æ§åˆ¶    | ç”Ÿæˆå¤šä¸ªå€™é€‰æ–¹æ¡ˆ              |
| **Elicitation** | äº¤äº’å¼å¼•å¯¼     | å‘ç”¨æˆ·ç¡®è®¤æ“ä½œ                |



## 3ã€åè®®åå•†æœºåˆ¶ï¼šåŠ¨æ€å‘ç°å¯¹æ–¹èƒ½åŠ›

### 1ï¼‰èƒ½åŠ›å£°æ˜æµç¨‹

1. `Client` å‘é€åŒ…å«åè®®ç‰ˆæœ¬å’Œèƒ½åŠ›çš„ `initialize` è¯·æ±‚
2. `Server` ä»¥å…¶åè®®ç‰ˆæœ¬å’Œèƒ½åŠ›å“åº”
3. `Client` å‘é€ `initialized` é€šçŸ¥ä½œä¸ºç¡®è®¤
4. å¼€å§‹æ­£å¸¸æ¶ˆæ¯äº¤æ¢

![image-20251118141835190](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118141835190.png)





### 2ï¼‰èƒ½åŠ›å£°æ˜è¯¦è§£

```json
// æœåŠ¡å™¨èƒ½åŠ›å£°æ˜ç¤ºä¾‹
{
  "capabilities": {
    "resources": {
      "subscribe": true,    // æ”¯æŒèµ„æºå˜æ›´è®¢é˜…
      "listChanged": true   // æ”¯æŒåˆ—è¡¨å˜æ›´é€šçŸ¥
    },
    "tools": {
      "listChanged": false  // ä¸æ”¯æŒå·¥å…·åˆ—è¡¨å˜æ›´
    },
    "prompts": {},          // åŸºæœ¬æ”¯æŒï¼Œæ— ç‰¹æ®Šèƒ½åŠ›
    "logging": {}           // æ”¯æŒç»“æ„åŒ–æ—¥å¿—
  }
}
```





## 4ã€`JSON-RPC 2.0`ï¼š`MCP` çš„é€šä¿¡éª¨æ¶

### 1ï¼‰ä¸‰ç§æ¶ˆæ¯ç±»å‹

| ç±»å‹                   | ç‰¹å¾                            | ç”¨é€”                       |
| ---------------------- | ------------------------------- | -------------------------- |
| **è¯·æ±‚(Request)**      | æœ‰`id`å­—æ®µï¼ŒæœŸå¾…å“åº”            | è°ƒç”¨æ–¹æ³•ï¼ˆå¦‚`tools/list`ï¼‰ |
| **å“åº”(Response)**     | æœ‰ç›¸åŒ`id`ï¼Œå«`result`æˆ–`error` | è¿”å›æ“ä½œç»“æœ               |
| **é€šçŸ¥(Notification)** | æ— `id`å­—æ®µï¼Œæ— éœ€å“åº”            | è¿›åº¦æ›´æ–°ã€èµ„æºå˜æ›´é€šçŸ¥     |

### 2ï¼‰å…¸å‹é€šä¿¡æµç¨‹

```json
// è¯·æ±‚ï¼šåˆ—å‡ºå·¥å…·
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/list"
}

// å“åº”ï¼šè¿”å›å·¥å…·åˆ—è¡¨
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "tools": [
      {
        "name": "query",
        "inputSchema": {
          "type": "object",
          "properties": {
            "sql": {"type": "string"}
          }
        }
      }
    ]
  }
}

// é€šçŸ¥ï¼šè¿›åº¦æ›´æ–°ï¼ˆæ— éœ€å“åº”ï¼‰
{
  "jsonrpc": "2.0",
  "method": "notifications/progress",
  "params": {
    "progress": 75,
    "message": "æ­£åœ¨å¤„ç†å¤§é‡æ•°æ®..."
  }
}
```



### 3ï¼‰é”™è¯¯å¤„ç†æ ‡å‡†åŒ–

| é”™è¯¯ç    | å«ä¹‰           | å¤„ç†å»ºè®®                   |
| -------- | -------------- | -------------------------- |
| `-32700` | JSONè§£æé”™è¯¯   | æ£€æŸ¥æ¶ˆæ¯æ ¼å¼               |
| `-32601` | æ–¹æ³•ä¸å­˜åœ¨     | æ£€æŸ¥èƒ½åŠ›å£°æ˜ï¼Œç¡®è®¤æ–¹æ³•æ”¯æŒ |
| `-32602` | å‚æ•°æ— æ•ˆ       | éªŒè¯å‚æ•°æ˜¯å¦ç¬¦åˆschema     |
| `-32603` | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | é‡è¯•æˆ–é™çº§å¤„ç†             |
| `-32002` | èµ„æºæœªæ‰¾åˆ°     | æ£€æŸ¥URIè·¯å¾„æ˜¯å¦æ­£ç¡®        |



## 5ã€ä¼ è¾“æ–¹å¼

### 1ï¼‰`Stdio` `Transport`ï¼ˆæœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ï¼‰

![image-20251118145457151](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118145457151.png)



**ä¼˜åŠ¿**ï¼š

- ç®€å•ç›´æ¥ï¼Œé€‚åˆ `CLI`å·¥å…·ã€IDEæ’ä»¶

- è¿›ç¨‹éš”ç¦»ï¼Œå´©æºƒä¸ä¼šå½±å“ä¸»ç¨‹åº

- è‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼ˆå­è¿›ç¨‹é€€å‡ºæ—¶çˆ¶è¿›ç¨‹æ„ŸçŸ¥ï¼‰

**æ¶ˆæ¯æ ¼å¼**ï¼š

```
{"jsonrpc":"2.0","id":1,"method":"tools/list"}\n
{"jsonrpc":"2.0","id":1,"result":{...}}\n
```



### 2ï¼‰`HTTP` ä¼ è¾“ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

- å®¢æˆ·ç«¯é€šè¿‡ HTTP POST å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨é€šè¿‡ Server-Sent Eventsï¼ˆSSEï¼‰æ¨é€å“åº”ã€‚
- å…¸å‹ç”¨äºæµè§ˆå™¨ç«¯å®æ—¶æµå¼è¾“å‡ºï¼ˆå¦‚ç½‘é¡µèŠå¤©ç•Œé¢ï¼‰ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTP POST         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚         â”‚
â”‚ å®¢æˆ·ç«¯  â”‚  è¯·æ±‚/é€šçŸ¥/å“åº”(JSON-RPC) â”‚ æœåŠ¡å™¨  â”‚
â”‚         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     HTTP å“åº”/SSEæµ       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é«˜çº§ç‰¹æ€§**ï¼š

- **`SSE` æµå¼å“åº”ï¼ˆå…è®¸æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€å®æ—¶æ›´æ–°çš„æŠ€æœ¯ï¼‰**ï¼šé€‚åˆé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œ
- **ä¼šè¯ç®¡ç†**ï¼šé€šè¿‡`Mcp-Session-Id`å¤´ä¿æŒä¸Šä¸‹æ–‡
- **æ–­çº¿é‡è¿**ï¼šä½¿ç”¨`Last-Event-ID`æ¢å¤ä¸­æ–­çš„æµ

**è¯·æ±‚ç¤ºä¾‹**ï¼š

```http
POST /mcp HTTP/1.1
Host: localhost:8080
Content-Type: application/json
Accept: application/json, text/event-stream
Mcp-Session-Id: abc123

{"jsonrpc":"2.0","id":1,"method":"tools/list"}
```

**`SSE` å“åº”ç¤ºä¾‹**ï¼š

```http
HTTP/1.1 200 OK
Content-Type: text/event-stream
Mcp-Session-Id: abc123

id: 1
data: {"jsonrpc":"2.0","method":"notifications/progress","params":{"progress":25}}

id: 2  
data: {"jsonrpc":"2.0","id":1,"result":{"content":[...]}}
```





### 3ï¼‰`WebSocket Transport`ï¼ˆå…¨åŒå·¥é€šä¿¡ï¼‰

- æä¾›ä½å»¶è¿Ÿã€é«˜é¢‘ç‡å®æ—¶äº¤äº’èƒ½åŠ›ã€‚
- åŸºäº `WebSocket` å…¨åŒå·¥é€šé“ï¼Œå»ºç«‹åå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥éšæ—¶æ¨é€ `JSON-RPC` æ¶ˆæ¯ã€‚é€‚åˆä½å»¶è¿Ÿã€é«˜é¢‘ç‡çš„å®æ—¶åŒå‘äº¤äº’ï¼Œä»¥åŠçœŸæ­£çš„å…¨åŒå·¥ `WebSocket `é€šé“ï¼Œä¸ºä½å»¶è¿Ÿã€é«˜é¢‘åŒå‘äº¤äº’æä¾›æœ€ä½³æ€§èƒ½ã€‚ã€‚





## 6ã€å®æˆ˜æ¡ˆä¾‹ï¼š`SQLite MCP` æœåŠ¡å™¨å®Œæ•´æµç¨‹

![image-20251118150229912](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118150229912.png)



### 1ï¼‰**èƒ½åŠ›åå•†**

```json
// å®¢æˆ·ç«¯åˆå§‹åŒ–
{
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "sampling": {},
      "roots": {}
    }
  }
}

// æœåŠ¡å™¨å“åº”
{
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "tools": {},
      "resources": {
        "subscribe": true
      }
    }
  }
}
```



### 2ï¼‰**å·¥å…·å‘ç°**

```json
// å®¢æˆ·ç«¯è¯·æ±‚
{
  "id": 2,
  "method": "tools/list"
}

// æœåŠ¡å™¨å“åº”
{
  "id": 2,
  "result": {
    "tools": [
      {
        "name": "query",
        "inputSchema": {
          "type": "object",
          "properties": {
            "sql": {"type": "string"}
          },
          "required": ["sql"]
        }
      }
    ]
  }
}
```



### 3ï¼‰**å·¥å…·è°ƒç”¨ä¸è¿›åº¦é€šçŸ¥**

```json
// å®¢æˆ·ç«¯è°ƒç”¨
{
  "id": 3,
  "method": "tools/call",
  "params": {
    "name": "query",
    "arguments": {
      "sql": "SELECT * FROM large_table"
    },
    "_meta": {
      "progressToken": "large-query-123"
    }
  }
}

// æœåŠ¡å™¨å‘é€è¿›åº¦
{
  "method": "notifications/progress",
  "params": {
    "progressToken": "large-query-123",
    "progress": 42,
    "total": 100,
    "message": "å·²å¤„ç†42%çš„è¡Œ"
  }
}

// æœåŠ¡å™¨æœ€ç»ˆå“åº”
{
  "id": 3,
  "result": {
    "content": [{"type": "table", "rows": [...]}]
  }
}
```









# äºŒã€`MCP` `Server`ï¼š

å¼€æºï¼šhttps://mcp.so/servers



## 1ã€ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½

> `MCP` æœåŠ¡å™¨é€šè¿‡å£°æ˜å…¶æ”¯æŒçš„èƒ½åŠ›ï¼Œå‘å®¢æˆ·ç«¯æš´éœ²ç»“æ„åŒ–çš„äº¤äº’æ¥å£ã€‚è¿™äº›èƒ½åŠ›åˆ†ä¸º **ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½**ï¼ˆ`Resources`ã€`Prompts`ã€`Tools`ï¼‰å’Œè‹¥å¹² **è¾…åŠ©æ‰©å±•åŠŸèƒ½**ï¼ˆè¡¥å…¨ã€æ—¥å¿—ã€åˆ†é¡µç­‰ï¼‰ï¼Œå…±åŒæ„æˆä¸€ä¸ªçµæ´»ã€å®‰å…¨ã€å¯ç»„åˆçš„ AI åä½œç”Ÿæ€ã€‚
>
>  **`MCP` çš„åŠ›é‡**ï¼šResources æä¾›ä¸Šä¸‹æ–‡ï¼ŒPrompts å¼•å¯¼æ„å›¾ï¼ŒTools æ‰§è¡ŒåŠ¨ä½œâ€”â€”ä¸‰è€…æ— ç¼åä½œã€‚

- **`Resources`**ï¼šæä¾›ä¸Šä¸‹æ–‡ï¼ˆWhat is availableï¼‰
- **`Prompts`**ï¼šå¼•å¯¼æ„å›¾ï¼ˆWhat the user wants to doï¼‰
- **`Tools`**ï¼šæ‰§è¡ŒåŠ¨ä½œï¼ˆWhat the AI decides to doï¼‰



### 1ï¼‰ `Resources`ï¼š`AI`çš„"çœ¼ç›"

> **æœ¬è´¨**ï¼šåªè¯»æ•°æ®æºï¼Œä¸ºAIæä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯
>
> > **`Resources`** æ˜¯æœåŠ¡å™¨æ‰˜ç®¡çš„**åªè¯»æ•°æ®å•å…ƒ**ï¼Œä»£è¡¨å¤–éƒ¨ä¸–ç•Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶ã€æ•°æ®åº“è®°å½•ã€`API` å“åº”ç­‰ã€‚å®ƒä»¬ä¸ä¸»åŠ¨æ‰§è¡Œé€»è¾‘ï¼Œä»…ä½œä¸º `AI` æ¨ç†çš„è¾“å…¥ä¾æ®ã€‚ï¼š

#### **aã€å…³é”®ç‰¹æ€§**ï¼š

- åº”ç”¨ç¨‹åºå®Œå…¨æ§åˆ¶å“ªäº›èµ„æºå¯è§
- ç»Ÿä¸€URIå‘½åç©ºé—´ï¼Œæ”¯æŒå¤šç§æ•°æ®æº
- æ”¯æŒå˜æ›´è®¢é˜…ï¼ˆå½“æ–‡ä»¶ä¿®æ”¹æ—¶è‡ªåŠ¨é€šçŸ¥AIï¼‰

#### **bã€æ ‡å‡†æ¥å£**

| æ–¹æ³•             | è¯´æ˜                         |
| ---------------- | ---------------------------- |
| `resources/list` | åˆ—å‡ºæ‰€æœ‰å¯ç”¨èµ„æºï¼ˆæ”¯æŒåˆ†é¡µï¼‰ |
| `resources/read` | è¯»å–æŒ‡å®š `URI` çš„èµ„æºå†…å®¹    |

#### **cã€`URI` å‘½åè§„èŒƒï¼ˆå»ºè®®ï¼‰**

- **å®‰å…¨å»ºè®®**ï¼šæœåŠ¡å™¨åº”å¯¹ URI è¿›è¡Œç™½åå•æ ¡éªŒï¼Œé˜²æ­¢è·¯å¾„éå†ï¼ˆå¦‚ `file:///etc/passwd`ï¼‰ã€‚

| æ–¹æ¡ˆ         | ç¤ºä¾‹                              | è¯´æ˜                                         |
| ------------ | --------------------------------- | -------------------------------------------- |
| `file://`    | `file:///project/src/main.py`     | æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ                                 |
| `db://`      | `db://users/table_schema`         | æ•°æ®åº“å…ƒæ•°æ®                                 |
| `git://`     | `git://commits?branch=main`       | `Git` æäº¤å†å²ï¼ˆæŸ¥è¯¢å‚æ•°åŒ–ï¼‰                 |
| `http(s)://` | `https://api.example.com/v1/data` | å¤–éƒ¨ APIï¼ˆéœ€æœåŠ¡ç«¯ä»£ç†ï¼Œé¿å…å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ï¼‰ |



#### **dã€å…¸å‹åœºæ™¯**ï¼š

- ä»£ç å®¡æŸ¥ï¼šAIè¯»å–`file:///src/user.py `å¹¶åˆ†æ
- æ•°æ®åˆ†æï¼šAIæŸ¥çœ‹`db://sales/monthly_report `ç”Ÿæˆæ‘˜è¦
- æ–‡æ¡£ç†è§£ï¼šAIè§£æ`file:///docs/API.md `å›ç­”ç”¨æˆ·é—®é¢˜





### 2ï¼‰ `Prompts`ï¼šç”¨æˆ·çš„"å¿«æ·æŒ‡ä»¤"

> **æœ¬è´¨**ï¼šé¢„å®šä¹‰çš„å·¥ä½œæµæ¨¡æ¿ï¼Œé™ä½ç”¨æˆ·ä½¿ç”¨é—¨æ§›   
>
> > `Prompt` å°±åƒæ˜¯ã€Œå¯¹è¯æ¨¡æ¿ã€æˆ–ã€Œå¿«æ·æŒ‡ä»¤ã€ï¼ŒæŠŠå¸¸ç”¨çš„å¤æ‚æŒ‡ä»¤é¢„è®¾å¥½ï¼Œç”¨æˆ·ä¸€é”®è°ƒç”¨ã€‚ç”¨ç”Ÿæ´»ä¸­çš„ä¾‹å­ç±»æ¯”ï¼Œå°±åƒå¾®ä¿¡çš„ã€Œå¿«æ·å›å¤ã€æˆ–IDEä¸­çš„ã€Œä»£ç ç‰‡æ®µ(Snippet)ã€ã€‚

#### **aã€ä¸ºä»€ä¹ˆéœ€è¦ `Prompts`**

- æ—  `Prompt`ï¼šç”¨æˆ·æ¯æ¬¡è¾“å…¥ `200` å­—çš„å¤æ‚æŒ‡ä»¤

- æœ‰`Prompt`ï¼šç”¨æˆ·ç‚¹å‡»"/analyze-commits" + é€‰æ‹©åˆ†æ”¯
  - é™ä½ç”¨æˆ·è®¤çŸ¥è´Ÿæ‹…ï¼›
  - æ ‡å‡†åŒ–é«˜é¢‘ä»»åŠ¡ï¼›
  - æ”¯æŒéæŠ€æœ¯ç”¨æˆ·ä½¿ç”¨é«˜çº§ `AI` åŠŸèƒ½ã€‚

#### **bã€æ•°æ®ç»“æ„**

```json
{
  "name": "analyze_commits",
  "title": "ğŸ“Š æäº¤å†å²åˆ†æ",
  "description": "åˆ†æGitæäº¤å†å²å¹¶ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š",
  "arguments": [
    {
      "name": "branch",
      "description": "è¦åˆ†æçš„åˆ†æ”¯",
      "required": true,
      "type": "string"
    },
    {
      "name": "since",
      "description": "æ—¶é—´èŒƒå›´(å¦‚'7 days ago')",
      "required": false,
      "type": "string"
    }
  ]
}
```





#### cã€å·¥ä½œæµç¨‹ï¼š

1. æœåŠ¡å™¨å£°æ˜æ”¯æŒ`prompts`èƒ½åŠ›
2. å®¢æˆ·ç«¯è·å–å¯ç”¨Promptåˆ—è¡¨ï¼ˆ`prompts/list`ï¼‰
3. ç”¨æˆ·é€‰æ‹© `Prompt` å¹¶å¡«å†™å‚æ•°
4. æœåŠ¡å™¨ç”Ÿæˆå®Œæ•´å¯¹è¯æ¶ˆæ¯ï¼ˆ`prompts/get`ï¼‰
5. æ¶ˆæ¯ç›´æ¥é€å…¥ `AI` æ‰§è¡Œ





#### **dã€å†…å®¹ç±»å‹æ”¯æŒ**

> **ç»„åˆèƒ½åŠ›**ï¼š`Prompt` å¯å†…åµŒ `resource`ï¼Œå®ç°â€œåŸºäºæŸæ–‡ä»¶è¿›è¡Œå®¡æŸ¥â€ç­‰åœºæ™¯ã€‚

| ç±»å‹          | ç»“æ„                                                         | ç”¨é€”             |
| ------------- | ------------------------------------------------------------ | ---------------- |
| `text`        | `{ "type": "text", "text": "..." }`                          | æ™®é€šæŒ‡ä»¤         |
| `image`       | `{ "type": "image", "data": "...", "mimeType": "..." }`      | å›¾åƒåˆ†æ         |
| `resource`    | `{ "type": "resource", "resource": { uri, text, mimeType } }` | å¼•ç”¨ MCP èµ„æº    |
| `tool_result` | ï¼ˆæœªæ¥æ‰©å±•ï¼‰                                                 | æ³¨å…¥å·¥å…·æ‰§è¡Œç»“æœ |



#### eã€ç”¨æˆ·æ„ŸçŸ¥ vs AI æ„ŸçŸ¥

| èƒ½åŠ›     | ç”¨æˆ·æ˜¯å¦å¯è§ | AI æ˜¯å¦å¯è§ | è§¦å‘æ–¹å¼               |
| -------- | ------------ | ----------- | ---------------------- |
| Prompt   | æ˜¯           | æ˜¯          | ç”¨æˆ·ä¸»åŠ¨é€‰æ‹©           |
| Tool     | å¦ï¼ˆé€šå¸¸ï¼‰   | æ˜¯          | AI è‡ªä¸»è°ƒç”¨            |
| Resource | é€æ˜         | æ˜¯          | åº”ç”¨è‡ªåŠ¨é™„åŠ æˆ–ç”¨æˆ·é€‰æ‹© |



### 3ï¼‰ `Tools`ï¼ˆå·¥å…·ï¼‰`AI`çš„"åŒæ‰‹"

> **æœ¬è´¨**ï¼šå¯æ‰§è¡Œå‡½æ•°ï¼Œè®©AIèƒ½ä¸»åŠ¨æ“ä½œå¤–éƒ¨ç³»ç»Ÿ
>
> > **`Tools`** æ˜¯æœåŠ¡å™¨æš´éœ²çš„**å¯æ‰§è¡Œå‡½æ•°**ï¼Œæ¯”å¦‚ ï¼Œæ¯”å¦‚æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨ `API`ã€å†™æ–‡ä»¶ã€‚ `AI` åœ¨æ¨ç†è¿‡ç¨‹ä¸­æ ¹æ®éœ€è¦åŠ¨æ€è°ƒç”¨ï¼Œä»¥è·å–ä¿¡æ¯æˆ–æ‰§è¡Œæ“ä½œï¼ˆå¦‚æŸ¥è¯¢ã€å†™å…¥ã€å‘é€é‚®ä»¶ï¼‰ã€‚



#### aã€**ä¸`Resources` çš„åŒºåˆ«**ï¼š

- **ç”± `AI` æ¨¡å‹å†³ç­–**ï¼šåŸºäºå½“å‰å¯¹è¯ä¸Šä¸‹æ–‡åˆ¤æ–­æ˜¯å¦è°ƒç”¨ï¼›
- **ç”±æœåŠ¡å™¨å®ç°**ï¼šå®šä¹‰å·¥å…·è¡Œä¸ºä¸å‰¯ä½œç”¨ã€‚

| ç‰¹æ€§         | Resources        | Tools               |
| ------------ | ---------------- | ------------------- |
| **è¯»å†™**     | åªè¯»             | å¯è¯»å†™ï¼ˆæ‰§è¡ŒåŠ¨ä½œï¼‰  |
| **æ§åˆ¶è€…**   | åº”ç”¨å†³å®šæš´éœ²ä»€ä¹ˆ | AIå†³å®šä½•æ—¶è°ƒç”¨      |
| **ç”¨æˆ·æ„ŸçŸ¥** | é€šå¸¸é€æ˜         | é€šå¸¸å¯¹ç”¨æˆ·éšè—      |
| **ç¤ºä¾‹**     | è¯»å–æ–‡ä»¶å†…å®¹     | å†™å…¥æ–°æ–‡ä»¶/å‘é€é‚®ä»¶ |



#### bã€æ ‡å‡†æ¥å£

| æ–¹æ³•         | è¯´æ˜                             |
| ------------ | -------------------------------- |
| `tools/list` | åˆ—å‡ºå¯ç”¨å·¥å…·ï¼ˆå« `inputSchema`ï¼‰ |
| `tools/call` | æ‰§è¡Œå·¥å…·è°ƒç”¨                     |

#### cã€å·¥å…·æè¿°ç¤ºä¾‹

**è¾“å…¥ï¼š**

```json
// åˆ—å‡ºå¯ç”¨å·¥å…·
{"method": "tools/list"}

// AIè°ƒç”¨å·¥å…·
{
  "method": "tools/call",
  "params": {
    "name": "get_weather",
    "arguments": {"city": "åŒ—äº¬"}
  }
}
```

**è¾“å‡ºï¼š**

```json
{
  "content": [{
    "type": "text",
    "text": "åŒ—äº¬å¤©æ°”:æ™´,æ¸©åº¦22Â°C"
  }],
  "isError": false
}
```



### 4ï¼‰å…¶ä»–åŠŸèƒ½

#### aã€æ™ºèƒ½è¡¥å…¨

- **åœºæ™¯**ï¼šç”¨æˆ·è¾“å…¥`/ana`æ—¶è‡ªåŠ¨æç¤º`/analyze-commits`

- æŠ€æœ¯ç»†èŠ‚ï¼š

  - æ”¯æŒ`ref/prompt`å’Œ`ref/resource`ä¸¤ç§å¼•ç”¨ç±»å‹
  - æ¯æ¬¡æœ€å¤š100ä¸ªå»ºè®®ï¼ŒæŒ‰ç›¸å…³æ€§æ’åº
  - æ”¯æŒåˆ†é¡µï¼ˆ`nextCursor`ï¼‰

- å®ç°ç¤ºä¾‹

  ```json
  // è¯·æ±‚
  { "method": "completion/complete", 
    "params": { "ref": "ref/prompt", "partialValue": "/ana" } }
  
  // å“åº”
  { "items": [
      { "value": "/analyze-commits", "label": "ğŸ“Š æäº¤åˆ†æ" },
      { "value": "/analyze-logs", "label": "ğŸ” æ—¥å¿—åˆ†æ" }
    ]
  }
  ```



#### bã€ç»“æ„åŒ–æ—¥å¿—

- **ä»·å€¼**ï¼šè®©`AI` æ“ä½œå¯è§‚å¯Ÿã€å¯è°ƒè¯•

- è®¾è®¡ï¼š

  - éµå¾ªRFC 5424æ ‡å‡†ï¼ˆdebug/info/warning/errorï¼‰
  - æ”¯æŒä»»æ„JSONæ•°æ®é™„åŠ 
  - å®¢æˆ·ç«¯å¯åŠ¨æ€è®¾ç½®æ—¥å¿—çº§åˆ«

- é€šçŸ¥ç¤ºä¾‹

  ```json
  {
    "method": "notifications/message",
    "params": {
      "level": "info",
      "logger": "git-analyzer",
      "message": "åˆ†æäº†23æ¬¡æäº¤",
      "data": { "branch": "main", "duration_ms": 1250 }
    }
  }
  ```



#### cã€åˆ†é«˜æ•ˆåˆ†é¡µ

- **ä¸ºä»€ä¹ˆä¸ç”¨é¡µç **ï¼Ÿå¤§æ•°æ®é›†ä¸‹åç§»é‡æ€§èƒ½å·®

- è§£å†³æ–¹æ¡ˆï¼šä¸é€æ˜æ¸¸æ ‡ï¼ˆOpaque Cursorï¼‰

  ```
  // å“åº”ç¤ºä¾‹
  {
    "tools": [ /* å½“å‰é¡µç»“æœ */ ],
    "nextCursor": "cursor_abc123" // å®¢æˆ·ç«¯ä¸è§£æå†…å®¹
  }
  ```

- **æ”¯æŒçš„æ“ä½œ**ï¼š`resources/list`, `prompts/list`, `tools/list`





# ä¸‰ã€`MCP` `Client`ï¼š

## 1ã€`MCP Client` çš„è®¾è®¡ç›®æ ‡

> **è®© LLM æˆä¸ºâ€œå†³ç­–è€…â€ï¼ŒMCP Client æˆä¸ºâ€œæ‰§è¡Œè€…â€**

1. **ç†è§£ç”¨æˆ·æ„å›¾**ï¼šç»“åˆä¸Šä¸‹æ–‡åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·ã€‚
2. **æ ‡å‡†åŒ–è°ƒç”¨å¤–éƒ¨èƒ½åŠ›**ï¼šé€šè¿‡ç»Ÿä¸€åè®®å¯¹æ¥å„ç±»æœåŠ¡ï¼ˆæ–‡ä»¶ã€APIã€AI æ¨¡å‹ç­‰ï¼‰ã€‚
3. **æ•´åˆç»“æœå¹¶åé¦ˆ**ï¼šå°†å·¥å…·è¾“å‡ºç»“æ„åŒ–åäº¤è¿˜ LLMï¼Œç”Ÿæˆè¿è´¯å“åº”ã€‚



### 1ï¼‰ä» `Function Calling` åˆ° `Tool Calling`

| å¯¹æ¯”é¡¹       | Function Callingï¼ˆæ—§ï¼‰ | Tool Callingï¼ˆæ–°ï¼‰                  |
| ------------ | ---------------------- | ----------------------------------- |
| **æ¦‚å¿µ**     | å‡½æ•°è°ƒç”¨ï¼Œå¼ºè°ƒâ€œå‡½æ•°â€   | å·¥å…·è°ƒç”¨ï¼Œå¼ºè°ƒâ€œå·¥å…·/èƒ½åŠ›â€           |
| **æ¥å£**     | `FunctionCallback`     | `ToolCallback`                      |
| **æ¨¡å‹æ”¯æŒ** | ä¸»è¦ `OpenAI`          | `OpenAI`ã€Geminiã€Qwenã€Moonshot ç­‰ |
| **æŠ½è±¡å±‚çº§** | ä½ï¼ˆä»…å‡½æ•°ï¼‰           | é«˜ï¼ˆAPI/æ’ä»¶/Agent å‡å¯ï¼‰           |
| **ç”Ÿæ€è¶‹åŠ¿** | å·²åºŸå¼ƒ                 | å®˜æ–¹ä¸»æ¨                            |



**é—®é¢˜1ï¼šä¸ºä»€ä¹ˆå‡çº§ï¼Ÿåªæ˜¯å‘½åå’Œæ¥å£æŠ½è±¡çš„å‡çº§ï¼ŒåŠŸèƒ½ç›®æ ‡æ˜¯ä¸€è‡´çš„ï¼Œå³è®© LLM è°ƒç”¨å¤–éƒ¨èƒ½åŠ›ã€‚**

- **åŠŸèƒ½æ›´é€šç”¨**ï¼šTool Calling æŠ½è±¡ä¸ä»…å¯ä»¥è¡¨ç¤ºå‡½æ•°ï¼Œè¿˜èƒ½è¡¨ç¤º APIã€Agentã€æ’ä»¶ç­‰ä¸€åˆ‡â€œå¤–éƒ¨èƒ½åŠ›â€ï¼Œæ›´é€šç”¨ã€æ›´æ˜“æ‰©å±•ã€‚

- **æ¥å£è®¾è®¡æ›´åˆç†**ï¼šToolCallbackã€ToolCallingManager ç­‰æ–°æ¥å£æ›´çµæ´»ã€æ›´æ˜“äºé€‚é…å¤šç§ç”¨ä¾‹ã€‚

- **å…¼å®¹æ€§æ›´å¥½**ï¼šæ–°æ¥å£èƒ½é€‚é…æ›´å¤š LLM å‚å•†çš„æ‰©å±•èƒ½åŠ›ï¼Œæ”¯æŒå¤šæ¨¡å‹ã€å¤šåç«¯ã€‚

- **ç¤¾åŒºä¸ç”Ÿæ€è¶‹åŠ¿**ï¼šä¸šç•Œé€æ­¥æ”¾å¼ƒ function calling è¿™ä¸€å‘½åï¼Œè½¬å‘ tool callingï¼Œæœ‰åŠ©äºæ–‡æ¡£ã€æ•™ç¨‹ã€ç”Ÿæ€å·¥å…·çš„ç»Ÿä¸€ã€‚



### 2ï¼‰ä¼ è¾“åè®®æ”¯æŒ

| ä¼ è¾“æ–¹å¼         | é€‚ç”¨åœºæ™¯                   | ç‰¹ç‚¹                                      |
| ---------------- | -------------------------- | ----------------------------------------- |
| **`Stdio`**      | æœ¬åœ°è¿›ç¨‹ï¼ˆå¦‚ CLI å·¥å…·ï¼‰    | é«˜æ•ˆã€ä½å»¶è¿Ÿï¼Œé€šè¿‡ stdin/stdout é€šä¿¡      |
| **`HTTP + SSE`** | Web åº”ç”¨ã€è¿œç¨‹æœåŠ¡         | å®¢æˆ·ç«¯ POST è¯·æ±‚ï¼ŒæœåŠ¡å™¨ SSE æ¨é€æµå¼å“åº” |
| **`WebSocket`**  | å®æ—¶åŒå‘äº¤äº’ï¼ˆå¦‚æ¡Œé¢åº”ç”¨ï¼‰ | å…¨åŒå·¥ï¼Œä½å»¶è¿Ÿï¼Œé€‚åˆé«˜é¢‘äº¤äº’              |



### 3ï¼‰è°å¼€å‘å®¢æˆ·ç«¯

> **åœ¨ MCP ç”Ÿæ€ä¸­ï¼Œå®¢æˆ·ç«¯ï¼ˆMCP Clientï¼‰é€šå¸¸ä¸ç”±ä¸‹æ¸¸å¼€å‘è€…ç¼–å†™ï¼Œè€Œæ˜¯ç”± AI åº”ç”¨å¹³å°ï¼ˆå¦‚ Claudeã€Cursorã€Windsurf ç­‰ï¼‰å†…ç½®æä¾›ã€‚**å¼€å‘è€…åªéœ€ä¸“æ³¨äº **å®ç° `MCP` æœåŠ¡å™¨ï¼ˆMCP Serverï¼‰**ï¼Œå³å¯è®©è‡ªå·±çš„å·¥å…·è¢«ä¸»æµ AI å¹³å°æ— ç¼è°ƒç”¨ã€‚

![image-20251118152524152](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118152524152.png)



1. **ä½ **å¼€å‘ä¸€ä¸ª MCP Serverï¼ˆä¾‹å¦‚ï¼šæ–‡ä»¶æœç´¢ã€æ•°æ®åº“æŸ¥è¯¢ã€Git æ“ä½œç­‰ï¼‰ï¼›
2. ç”¨æˆ·åœ¨ **Claude Desktopã€Cursorã€Windsurf** ç­‰ AI å·¥å…·ä¸­å¯ç”¨ä½ çš„æœåŠ¡ï¼›
3. è¿™äº› AI å¹³å°**å†…ç½®çš„ MCP Client** è‡ªåŠ¨ä¸ä½ çš„ Server å»ºç«‹è¿æ¥ï¼›
4. å½“ LLM éœ€è¦è°ƒç”¨ä½ çš„èƒ½åŠ›æ—¶ï¼Œå¹³å°é€šè¿‡æ ‡å‡†åè®®å‘èµ·è¯·æ±‚ï¼›
5. ä½ æ— éœ€å…³å¿ƒâ€œAI æ€ä¹ˆè°ƒæˆ‘â€ï¼Œåªéœ€æŒ‰åè®®å“åº”å³å¯ã€‚







## 2ã€ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›

### 1ï¼‰`Sampling`ï¼ˆé‡‡æ ·ï¼‰ï¼šæœåŠ¡å™¨è¯·æ±‚å®¢æˆ·ç«¯è°ƒç”¨ `AI`

- **æ„ä¹‰**ï¼šå®ç° **å¤šæ¨¡å‹åä½œ** æˆ– **è½»é‡æœåŠ¡ + å¼º `AI` åå¤‡** çš„æ··åˆæ¶æ„ã€‚

- **åœºæ™¯**ï¼šæœåŠ¡å™¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ï¼Œéœ€å€ŸåŠ©æ›´å¼ºçš„ `AI` åˆ†æä¸­é—´ç»“æœã€‚

  - **ç¤ºä¾‹**ï¼šæ–‡ä»¶ç³»ç»ŸæœåŠ¡åœ¨æœç´¢å¤§é‡æ—¥å¿—åï¼Œé—®ï¼šâ€œè¿™äº›é”™è¯¯æ—¥å¿—ä¸­å“ªäº›æœ€ä¸¥é‡ï¼Ÿâ€

- åè®®ç¤ºä¾‹

  ```json
  {
    "method": "sampling/createMessage",
    "params": {
      "messages": [{ "role": "user", "content": { "type": "text", "text": "è¿™ä¸ªæ•°æ®æ­£å¸¸å—?" } }],
      "modelPreferences": {
        "hints": [{"name": "claude-3-sonnet"}],
        "intelligencePriority": 0.8,
        "speedPriority": 0.5
      }
    }
  }
  ```



### 2ï¼‰`Roots`ï¼ˆç›®å½•ï¼‰ï¼šé™å®šæœåŠ¡å™¨æ“ä½œèŒƒå›´

- **å®‰å…¨ä»·å€¼**ï¼šç±»ä¼¼æ²™ç®±æœºåˆ¶ï¼Œä¿æŠ¤ç”¨æˆ·éšç§å’Œç³»ç»Ÿå®‰å…¨ã€‚

- **åœºæ™¯**ï¼šç¡®ä¿å®‰å…¨ï¼Œé˜²æ­¢æœåŠ¡å™¨è¶Šæƒè®¿é—®ç”¨æˆ·æ–‡ä»¶ã€‚

- **æœºåˆ¶**ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨ä¸ŠæŠ¥â€œå…è®¸è®¿é—®çš„æ ¹ç›®å½•â€ã€‚

- è¯·æ±‚/å“åº”

  ```json
  // å®¢æˆ·ç«¯è¯·æ±‚
  { "method": "roots/list" }
  
  // æœåŠ¡å™¨æ”¶åˆ°ååªèƒ½æ“ä½œè¿™äº›è·¯å¾„
  {
    "roots": [{
      "uri": "file:///home/user/project",
      "name": "æˆ‘çš„é¡¹ç›®"
    }]
  }
  ```



### 3ï¼‰ `Elicitation`ï¼ˆå¼•å¯¼ï¼‰ï¼šæœåŠ¡å™¨å‘ç”¨æˆ·ç´¢è¦ä¿¡æ¯

- **ä¼˜åŠ¿**ï¼šæ‰“é€š **AI â†’ ç”¨æˆ· â†’ AI** çš„äººæœºååŒé—­ç¯

- **åœºæ™¯**ï¼šä»»åŠ¡ç¼ºå°‘å…³é”®è¾“å…¥ï¼Œéœ€äººå·¥ä»‹å…¥ã€‚

- **ç¤ºä¾‹**ï¼š`Git` å·¥å…·éœ€è¦æäº¤è§„èŒƒï¼Œå¼¹çª—é—®ï¼šâ€œè¯·é€‰æ‹©æ ¼å¼ï¼šConventional Commits / Angular / Customï¼Ÿâ€

- äº¤äº’æµç¨‹

  ```json
  // æœåŠ¡å™¨å‘èµ·å¼•å¯¼
  {
    "method": "elicitation/create",
    "params": {
      "message": "è¯·æä¾›æ‚¨çš„GitHubç”¨æˆ·å",
      "requestedSchema": {
        "type": "object",
        "properties": { "username": { "type": "string" } }
      }
    }
  }
  
  // ç”¨æˆ·å“åº”
  {
    "action": "accept",
    "content": { "username": "octocat" }
  }
  ```



# å…­ã€`FAQ`

## 1ã€`MCP` æƒé™å®‰å…¨

![image-20251118212844626](/Users/zhangyujin1/Desktop/HealerJean/HCode/HealerJean.github.io/blogImages/image-20251118212844626.png)

- **è´£ä»»åˆ’åˆ†**ï¼š

  - **`MCP` `Client`**ï¼ˆ`AI` å¹³å°ï¼‰ï¼šè´Ÿè´£ç”¨æˆ·æˆæƒå¼¹çª—ã€ä¼šè¯çº§æƒé™ç®¡ç†

  - **`MCP` `Server`**ï¼ˆä½ çš„æœåŠ¡ï¼‰ï¼šè´Ÿè´£èµ„æºè¾¹ç•Œæ§åˆ¶ã€æ“ä½œåˆæ³•æ€§éªŒè¯

  - **ç”¨æˆ·**ï¼šæœ€ç»ˆå†³ç­–è€…ï¼Œæ§åˆ¶æ¯ä¸ªæ•æ„Ÿæ“ä½œçš„æˆæƒ
    - **æ§åˆ¶æ¯ä¸ªæ•æ„Ÿæ“ä½œ = æ¯æ¬¡å±é™©è¯·æ±‚éƒ½éœ€è¦ä½ ç‚¹å‡»ç¡®è®¤**
    - **ä¸æ˜¯æŠ€æœ¯é™åˆ¶ï¼Œè€Œæ˜¯å®‰å…¨è®¾è®¡**ï¼šå®å¯éº»çƒ¦ç”¨æˆ·10ç§’ï¼Œä¹Ÿä¸è®©AIçŠ¯ä¸€ä¸ªä¸å¯é€†çš„é”™è¯¯

- ä¸‰å¤§æ ¸å¿ƒæƒé™æ§åˆ¶æœºåˆ¶

  - **`Roots` é™åˆ¶**ï¼šåªå…è®¸è®¿é—®æŒ‡å®šç›®å½•

  - **å·¥å…·åˆ†çº§**ï¼šè¯»/å†™/æ‰§è¡Œæƒé™åˆ†å¼€æ§åˆ¶

  - **å¿…é¡»å®¡è®¡**ï¼šè®°å½•æ‰€æœ‰æ•æ„Ÿæ“ä½œ

















![ContactAuthor](https://raw.githubusercontent.com/HealerJean/HealerJean.github.io/master/assets/img/artical_bottom.jpg)



<!-- Gitalk è¯„è®º start  -->

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>Â 
<div id="gitalk-container"></div>Â    
 <script type="text/javascript">
    var gitalk = new Gitalk({
		clientID: `1d164cd85549874d0e3a`,
		clientSecret: `527c3d223d1e6608953e835b547061037d140355`,
		repo: `HealerJean.github.io`,
		owner: 'HealerJean',
		admin: ['HealerJean'],
		id: 'AAAAAAAAAAAAAAAAAA',
    });
    gitalk.render('gitalk-container');
</script>Â 



<!-- Gitalk end -->



